(self.webpackJsonp=self.webpackJsonp||[]).push([[8],{508:function(e,t,n){"use strict";t.a=function(e){if(e.includes("."))switch(e.split(".").pop()){case"js":return"javascript";case"ts":case"tsx":return"typescript";case"json":return"json";case"css":return"css";case"html":return"html";case"md":return"markdown";default:return}}},595:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n(10);var a=n(508);async function i(e,t){let i,s;switch(Object(a.a)(e)){case"javascript":i="babel",s=[await n.e(21).then(n.t.bind(null,656,7))];break;case"typescript":i="typescript",s=[await n.e(23).then(n.t.bind(null,657,7))];break;case"markdown":i="markdown",s=await Promise.all([n.e(21).then(n.t.bind(null,656,7)),n.e(23).then(n.t.bind(null,657,7)),n.e(22).then(n.t.bind(null,891,7))])}if(i&&s){const e=await n.e(24).then(n.t.bind(null,892,7)),{default:a}=await n.e(12).then(n.t.bind(null,893,3));return e.format(t,{parser:i,plugins:s,...a})}return t}},601:function(e,t,n){e.exports=n.p+"assets/018c0c569c00c0e707dcc30d1f40b354.png"},603:function(e,t,n){e.exports=n.p+"assets/7f658e7f03b868a6e934914996462329.png"},619:function(e){e.exports=JSON.parse('{"parser":"babel-eslint","parserOptions":{"sourceType":"module"},"env":{"es6":true},"plugins":["babel","flowtype","react","react-native","react-hooks"],"settings":{"flowtype":{"onlyFilesWithFlowAnnotation":true},"react":{"version":"detect"}},"globals":{"__DEV__":false,"__dirname":false,"alert":false,"Blob":false,"cancelAnimationFrame":false,"cancelIdleCallback":false,"clearImmediate":true,"clearInterval":false,"clearTimeout":false,"console":false,"escape":false,"Event":false,"EventTarget":false,"exports":false,"fetch":false,"File":false,"FileReader":false,"FormData":false,"global":false,"Map":true,"module":false,"navigator":false,"process":false,"Promise":true,"requestAnimationFrame":true,"requestIdleCallback":true,"require":false,"Set":true,"setImmediate":true,"setInterval":false,"setTimeout":false,"WebSocket":false,"window":false,"XMLHttpRequest":false},"rules":{"constructor-super":"error","no-case-declarations":"error","no-class-assign":"error","no-cond-assign":"error","no-const-assign":"error","no-constant-condition":"error","no-control-regex":"error","no-delete-var":"error","no-dupe-args":"error","no-dupe-class-members":"error","no-dupe-keys":"error","no-duplicate-case":"error","no-empty":"error","no-empty-character-class":"error","no-empty-pattern":"error","no-ex-assign":"error","no-extra-boolean-cast":"error","no-extra-semi":"error","no-fallthrough":"error","no-func-assign":"error","no-global-assign":"error","no-inner-declarations":"error","no-invalid-regexp":"error","no-new-symbol":"error","no-obj-calls":"error","no-octal":"error","no-redeclare":"error","no-regex-spaces":"error","no-self-assign":"error","no-sparse-arrays":"error","no-this-before-super":"error","no-undef":"error","no-unexpected-multiline":"error","no-unreachable":"error","no-unsafe-finally":"error","no-unsafe-negation":"error","no-unused-labels":"error","require-yield":"error","use-isnan":"error","valid-typeof":"error","flowtype/array-style-complex-type":"off","flowtype/array-style-simple-type":"off","flowtype/boolean-style":"off","flowtype/define-flow-type":"error","flowtype/delimiter-dangle":"off","flowtype/generic-spacing":"off","flowtype/newline-after-flow-annotation":"off","flowtype/no-dupe-keys":"error","flowtype/no-existential-type":"off","flowtype/no-flow-fix-me-comments":"off","flowtype/no-mutable-array":"off","flowtype/no-primitive-constructor-types":"off","flowtype/no-types-missing-file-annotation":"off","flowtype/no-unused-expressions":"off","flowtype/no-weak-types":"off","flowtype/object-type-delimiter":"off","flowtype/require-exact-type":"off","flowtype/require-parameter-type":"off","flowtype/require-return-type":"off","flowtype/require-types-at-top":"off","flowtype/require-valid-file-annotation":"off","flowtype/require-variable-type":"off","flowtype/semi":"off","flowtype/sort-keys":"off","flowtype/space-after-type-colon":"off","flowtype/space-before-generic-bracket":"off","flowtype/space-before-type-colon":"off","flowtype/type-id-match":"off","flowtype/type-import-style":"off","flowtype/union-intersection-spacing":"off","flowtype/use-flow-type":"off","flowtype/valid-syntax":"off","react/jsx-no-duplicate-props":"error","react/jsx-no-undef":"error","react/jsx-uses-react":"error","react/jsx-uses-vars":"error","react/no-deprecated":"error","react/no-did-mount-set-state":"error","react/no-did-update-set-state":"error","react/no-direct-mutation-state":"error","react/no-is-mounted":"error","react/no-string-refs":"error","react/react-in-jsx-scope":"error","react/require-render-return":"error","react-native/no-unused-styles":"error","react-hooks/rules-of-hooks":"error","react-hooks/exhaustive-deps":"error"}}')},670:function(e,t,n){e.exports=n.p+"assets/c51d82a43adccd86d66477bfc28dd39b.png"},671:function(e,t,n){e.exports=n.p+"assets/9682e34e1f058feab75a232e3b9f33c6.png"},672:function(e,t,n){e.exports=n.p+"assets/af05a3786092b27e789607af7f5ab349.png"},685:function(e,t,n){e.exports=n.p+"assets/1f423990e6bfdae184f966c86dc22c36.png"},698:function(e,t,n){},731:function(e,t){},744:function(e,t,n){e.exports=n.p+"assets/bc351fd24f9bd32bc131f122d42c1a77.svg"},957:function(e,t,n){"use strict";n.r(t);n(10),n(668);var a=n(1),i=n(89),s=n.n(i),r=n(0),o=n(40),l=n(20),c=n(55),d=n(162);async function p(e,t){const a=t[e];if(a&&"CODE"===a.type){if(Object(d.k)(e)&&a.contents)return async function(e,t,a){const i=Object.keys(a).find(d.e);let s;if(i)try{s={parser:"babel-eslint",...JSON.parse(a[i].contents)}}catch(e){return[{message:"Content of the ESLint config (".concat(i,") is not valid JSON"),location:{fileName:i,startLineNumber:0,endLineNumber:0,startColumn:0,endColumn:0},severity:4,source:"ESLint"}]}const{default:r}=await n.e(13).then(n.bind(null,898));return r(e,t,s)}(e,a.contents,t);if(Object(d.i)(e)){const{default:t}=await Promise.all([n.e(20),n.e(14)]).then(n.bind(null,899));return t(e,a.contents)}return[]}return[]}var h=n(595),m=n(2);function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class g extends r.PureComponent{constructor(...e){super(...e),u(this,"state",{layout:null}),u(this,"_handleImageLoad",e=>{const t=e.target;this.setState({layout:{height:t.naturalHeight,width:t.naturalWidth}})})}render(){var e,t;const{selectedFile:n,files:i}=this.props,s=n.includes(".")?n.split(".").pop():null;return r.createElement("div",{className:Object(a.css)(b.container)},r.createElement("div",{className:Object(a.css)(b.inner)},Object(d.g)(n.toLowerCase())?r.createElement("img",{onLoad:this._handleImageLoad,className:Object(a.css)(b.preview),src:null===(e=i[n])||void 0===e?void 0:e.contents}):r.createElement("svg",{width:"120px",height:"168px",viewBox:"0 0 120 168"},r.createElement("mask",{id:"mask-2",fill:"white"},r.createElement("rect",{x:"0",y:"0",width:"119.25",height:"168"})),r.createElement("g",{mask:"url(#mask-2)",fillRule:"nonzero",fill:Object(m.a)("border")},r.createElement("path",{d:"M2.25,0 L117.75,0 L117.75,0 C118.992641,-2.28269391e-16 120,1.00735931 120,2.25 L120,165.75 L120,165.75 C120,166.992641 118.992641,168 117.75,168 L2.25,168 L2.25,168 C1.00735931,168 1.52179594e-16,166.992641 0,165.75 L0,2.25 L0,2.25 C-1.52179594e-16,1.00735931 1.00735931,2.28269391e-16 2.25,0 Z M75,0 L120,45 L120,0 L75,0 Z"}),r.createElement("path",{d:"M77.25,-3 L120.75,-3 C121.992641,-3 123,-1.99264069 123,-0.75 L123,42.75 C123,43.9926407 121.992641,45 120.75,45 L77.25,45 C76.0073593,45 75,43.9926407 75,42.75 L75,-0.75 L75,-0.75 C75,-1.99264069 76.0073593,-3 77.25,-3 L77.25,-3 Z M75,0 L120,45 L120,0 L75,0 Z",fillOpacity:"0.2",fill:"#000000"}),r.createElement("text",{className:Object(a.css)(b.ext)},r.createElement("tspan",{x:"56",y:"100"},s?".".concat(s):"")))),r.createElement("a",{className:Object(a.css)(b.link),href:null===(t=i[n])||void 0===t?void 0:t.contents,target:"_blank",title:"Open in tab"},r.createElement("h4",{className:Object(a.css)(b.name)},n.split("/").pop())),r.createElement("div",{className:Object(a.css)(b.layout)},this.state.layout?"".concat(this.state.layout.height," x ").concat(this.state.layout.width):" ")))}}const b=a.StyleSheet.create({container:{flex:1,display:"flex",alignItems:"center",justifyContent:"center"},inner:{maxHeight:"100%",maxWidth:"100%",textAlign:"center"},name:{marginTop:"2em",fontWeight:500},layout:{opacity:.5},preview:{maxHeight:"100%",maxWidth:"100%",height:"auto",width:"auto"},ext:{fill:Object(m.a)("text"),fontFamily:"var(--font-monospace)",textAnchor:"middle",fontSize:20,opacity:.8},link:{textDecoration:"none",color:"inherit"}});var f=n(662),v=n(661),y=n(894),E=n(69),x=n(550),w=n(28),C=n.n(w),S=n(86);function O({sdkVersion:e,isLocalWebPreview:t,onChange:n,selectClassName:i}){const s=Object.keys(S.b).sort(),o=s.filter(t=>S.b[t]||t===e);return t&&o.push("localhost"),r.createElement("div",{className:Object(a.css)(j.container)},r.createElement("span",{className:Object(a.css)(j.label)},"Expo"),r.createElement("span",{className:Object(a.css)(j.switcher)},r.createElement("select",{value:t?"localhost":e,onChange:e=>n("localhost"===e.target.value?s[s.length-1]:e.target.value,"localhost"===e.target.value),className:C()(Object(a.css)(j.select),i)},o.map(e=>r.createElement("option",{className:Object(a.css)(j.option),key:e,value:e},"localhost"===e?e:"v".concat(e))))))}const j=a.StyleSheet.create({container:{display:"flex",alignItems:"center",whiteSpace:"nowrap",marginRight:".5em"},switcher:{position:"relative",display:"inline-block",":after":{content:'"▼"',color:Object(m.a)("soft"),position:"absolute",fontSize:"0.6em",right:"2em",top:"0.66em",pointerEvents:"none"}},label:{flex:1,margin:"0 .5em","@media (max-width: 480px)":{display:"none"}},select:{appearance:"none",backgroundColor:"transparent",padding:"0 2em 0 1em",borderRadius:12,outline:0,cursor:"pointer",border:"1px solid ".concat(Object(m.a)("border"))},option:{backgroundColor:Object(m.a)("content"),color:Object(m.a)("text")}});var _=n(215),k=n(598),L=n(552),D=n(589),N=n(597),M=n(509),P=n(496);function I(e){var t;const{annotations:i,connectedDevices:s,fileTreeShown:o,previewShown:l,panelsShown:c,sendCodeOnChangeEnabled:d,editorMode:p,sdkVersion:h,isLocalWebPreview:m,onSendCode:u,onReloadSnack:g,onToggleTheme:b,onTogglePanels:f,onToggleFileTree:v,onTogglePreview:y,onToggleSendCode:E,onToggleVimMode:w,onChangeSDKVersion:C,onShowModal:S,onPrettifyCode:j,theme:I}=e,T=s.length>1?"apps":"app",R=s.length>1?"devices":"device",A=i.filter(e=>e.severity<0),W=A.length>=1,z=!W&&i.some(e=>e.severity>3),H=i.filter(e=>2===e.severity).length;let B;if(W)B=W?"".concat(A[0].message).concat(A.length>1?" (+".concat(A.length-1," more)"):""):"";else{const e=i.filter(e=>e.severity>=3);if(e.length){const{message:t,location:n,action:i}=e[0],s=n?"".concat(n.fileName," (").concat(n.startLineNumber,":").concat(n.startColumn,") "):"",o=i?r.createElement("span",{className:Object(a.css)(F.action),onClick:e=>{e.stopPropagation(),i.run()}},i.title):e.length>1?"(+".concat(e.length-1," more)"):"";B=r.createElement("span",null,s,t.split("\n")[0]+" ",o)}}return r.createElement(_.a,{type:W?"loading":z?"error":null},r.createElement("div",{className:Object(a.css)(F.left)},W?r.createElement(D.a,{className:Object(a.css)(F.loadingText),onClick:()=>f("errors")},B):r.createElement("button",{onClick:()=>f(B?"errors":void 0),className:Object(a.css)(F.statusText,B?z?F.errorTextFatal:F.errorText:F.successText)},null!==(t=B)&&void 0!==t?t:"No errors".concat(H?", ".concat(H," warning").concat(H>1?"s":""):""))),r.createElement(k.a,{icon:n(670),onClick:j},r.createElement("span",{className:Object(a.css)(F.buttonLabel)},"Prettier")),r.createElement(N.a,{icon:n(600),label:r.createElement("span",{className:Object(a.css)(F.buttonLabel)},"Editor"),content:r.createElement(r.Fragment,null,r.createElement("div",{className:Object(a.css)(F.buttonItem,F.buttonItemEditorPane),onClick:()=>S("shortcuts")},r.createElement(L.a,{small:!0,title:"Show keyboard shortcuts",label:"Shortcuts"}),r.createElement(M.a,{combo:x.a.shortcuts.combo,className:Object(a.css)(F.buttonItemShortcut)})),r.createElement("div",{className:Object(a.css)(F.menuSeparator)}),r.createElement(P.a,{checked:o,onChange:v,label:"Files"}),r.createElement(P.a,{checked:c,onChange:()=>f(),label:"Panel"}),r.createElement(P.a,{checked:"light"!==I,onChange:b,label:"Dark theme"}),w?r.createElement(P.a,{checked:"vim"===p,onChange:w,label:"Vim mode"}):null)}),r.createElement(O,{sdkVersion:h,isLocalWebPreview:m,onChange:C,selectClassName:z&&Object(a.css)(F.errorBorder)||void 0}),r.createElement(N.a,{label:r.createElement(r.Fragment,null,r.createElement("span",{className:Object(a.css)(F.buttonLabel)},"Devices"),r.createElement("span",{className:Object(a.css)(F.devicesCount)},s.length)),content:r.createElement("div",{className:Object(a.css)(F.devicePane)},s.length?r.createElement(r.Fragment,null,r.createElement("div",{className:Object(a.css)(F.devicePaneItem)},r.createElement(P.a,{checked:d,onChange:E,label:"Update as you type"})),r.createElement("div",{className:Object(a.css)(F.buttonItem)},r.createElement(L.a,{small:!0,title:"Update changes on connected ".concat(R),label:"Update now",onClick:u},r.createElement("svg",{width:"14px",height:"17px",viewBox:"0 0 14 17"},r.createElement("path",{transform:"translate(-5.000000, -3.000000)",d:"M9,16 L15,16 L15,10 L19,10 L12,3 L5,10 L9,10 L9,16 Z M5,18 L19,18 L19,20 L5,20 L5,18 Z"}))),r.createElement(M.a,{combo:x.a.update.combo})),r.createElement("div",{className:Object(a.css)(F.buttonItem)},r.createElement(L.a,{small:!0,title:"Reload ".concat(T," on connected ").concat(R),label:"Reload ".concat(T),onClick:g},r.createElement("svg",{width:"16px",height:"20px",viewBox:"0 0 16 20"},r.createElement("path",{d:"M8,3.5 L8,0 L3,5 L8,10 L8,5.5 C11.314,5.5 14,8.186 14,11.5 C14,14.814 11.314,17.5 8,17.5 C4.686,17.5 2,14.814 2,11.5 L0,11.5 C0,15.918 3.582,19.5 8,19.5 C12.418,19.5 16,15.918 16,11.5 C16,7.082 12.418,3.5 8,3.5"})))),r.createElement("h4",{className:Object(a.css)(F.title)},"Connected devices"),s.map(e=>r.createElement("div",{key:e.id,className:Object(a.css)(F.deviceLabel)},"android"===e.platform?r.createElement("svg",{className:Object(a.css)(F.deviceIcon),width:"16px",height:"20px",viewBox:"0 0 16 20"},r.createElement("path",{transform:"translate(-16.000000, -146.000000)",d:"M19.2,160.325197 C19.2,160.762881 19.56,161.120986 20,161.120986 L20.8,161.120986 L20.8,163.906247 C20.8,164.566752 21.336,165.099931 22,165.099931 C22.664,165.099931 23.2,164.566752 23.2,163.906247 L23.2,161.120986 L24.8,161.120986 L24.8,163.906247 C24.8,164.566752 25.336,165.099931 26,165.099931 C26.664,165.099931 27.2,164.566752 27.2,163.906247 L27.2,161.120986 L28,161.120986 C28.44,161.120986 28.8,160.762881 28.8,160.325197 L28.8,152.367307 L19.2,152.367307 L19.2,160.325197 L19.2,160.325197 Z M17.2,152.367307 C16.536,152.367307 16,152.900485 16,153.56099 L16,159.131513 C16,159.792018 16.536,160.325197 17.2,160.325197 C17.864,160.325197 18.4,159.792018 18.4,159.131513 L18.4,153.56099 C18.4,152.900485 17.864,152.367307 17.2,152.367307 L17.2,152.367307 Z M30.8,152.367307 C30.136,152.367307 29.6,152.900485 29.6,153.56099 L29.6,159.131513 C29.6,159.792018 30.136,160.325197 30.8,160.325197 C31.464,160.325197 32,159.792018 32,159.131513 L32,153.56099 C32,152.900485 31.464,152.367307 30.8,152.367307 L30.8,152.367307 Z M26.824,147.719899 L27.868,146.681394 C28.024,146.526215 28.024,146.275542 27.868,146.120363 C27.712,145.965184 27.46,145.965184 27.304,146.120363 L26.12,147.294152 C25.48,146.979815 24.764,146.796784 24,146.796784 C23.232,146.796784 22.512,146.979815 21.868,147.298131 L20.68,146.116384 C20.524,145.961205 20.272,145.961205 20.116,146.116384 C19.96,146.271563 19.96,146.522237 20.116,146.677415 L21.164,147.719899 C19.976,148.591288 19.2,149.991877 19.2,151.571518 L28.8,151.571518 C28.8,149.987898 28.02,148.587309 26.824,147.719899 L26.824,147.719899 Z M26,149.978945 C26.2209139,149.978945 26.4,149.800802 26.4,149.581051 C26.4,149.361299 26.2209139,149.183156 26,149.183156 C25.7790861,149.183156 25.6,149.361299 25.6,149.581051 C25.6,149.800802 25.7790861,149.978945 26,149.978945 Z M22,149.978945 C22.2209139,149.978945 22.4,149.800802 22.4,149.581051 C22.4,149.361299 22.2209139,149.183156 22,149.183156 C21.7790861,149.183156 21.6,149.361299 21.6,149.581051 C21.6,149.800802 21.7790861,149.978945 22,149.978945 Z"})):"ios"===e.platform?r.createElement("svg",{className:Object(a.css)(F.deviceIcon),width:"16px",height:"16px",viewBox:"0 0 16 16"},r.createElement("path",{d:"M5,0 L11,0 C13.7614237,-5.07265313e-16 16,2.23857625 16,5 L16,11 C16,13.7614237 13.7614237,16 11,16 L5,16 C2.23857625,16 3.38176876e-16,13.7614237 0,11 L0,5 C-3.38176876e-16,2.23857625 2.23857625,5.07265313e-16 5,0 Z M2.79296875,11 L3.5,11 L3.5,6.890625 L2.79296875,6.890625 L2.79296875,11 Z M2.64453125,5.625 C2.64453125,5.90625 2.859375,6.11328125 3.140625,6.11328125 C3.4375,6.11328125 3.65234375,5.90625 3.65234375,5.625 C3.65234375,5.33984375 3.4375,5.1328125 3.140625,5.1328125 C2.859375,5.1328125 2.64453125,5.33984375 2.64453125,5.625 Z M9.20385423,8.71875 L9.20385423,7.94921875 C9.20385423,6.4375 8.36401048,5.55859375 7.05541673,5.55859375 C5.74682298,5.55859375 4.90697923,6.43359375 4.90697923,7.94921875 L4.90697923,8.71875 C4.90697923,10.2304688 5.74682298,11.109375 7.05541673,11.109375 C8.36401048,11.109375 9.20385423,10.2304688 9.20385423,8.71875 Z M10.1616147,9.64453125 C10.2358335,10.5039062 10.962396,11.109375 12.0913022,11.109375 C13.321771,11.109375 14.0913022,10.4726562 14.0913022,9.50390625 C14.0913022,8.7265625 13.634271,8.2890625 12.7006772,8.046875 L11.790521,7.80859375 C11.3022397,7.6875 11.040521,7.4296875 11.040521,7.0546875 C11.040521,6.53515625 11.4897397,6.1796875 12.1616147,6.1796875 C12.7827085,6.1796875 13.2045835,6.4765625 13.3022397,6.9453125 L14.024896,6.9453125 C13.9428647,6.1328125 13.228021,5.54296875 12.1733335,5.54296875 C11.087396,5.54296875 10.3100522,6.18359375 10.3100522,7.08984375 C10.3100522,7.8046875 10.7709897,8.29296875 11.571771,8.5 L12.4975522,8.73828125 C13.0952085,8.890625 13.3647397,9.13671875 13.3647397,9.5625 C13.3647397,10.1171875 12.9077085,10.4726562 12.165521,10.4726562 C11.4702085,10.4726562 10.9897397,10.1484375 10.8881772,9.64453125 L10.1616147,9.64453125 Z M8.48119798,7.94921875 L8.48119798,8.72265625 C8.48119798,9.89453125 7.86401048,10.4648438 7.05541673,10.4648438 C6.24291673,10.4648438 5.62963548,9.89453125 5.62963548,8.72265625 L5.62963548,7.94921875 C5.62963548,6.7734375 6.24291673,6.203125 7.05541673,6.203125 C7.86401048,6.203125 8.48119798,6.7734375 8.48119798,7.94921875 Z"})):r.createElement("svg",{width:"18px",height:"18px",viewBox:"0 0 18 18",className:Object(a.css)(F.deviceIcon),style:{stroke:"currentColor"}},r.createElement("g",{strokeWidth:"1",fill:"none"},r.createElement("circle",{cx:"9",cy:"9",r:"8"}),r.createElement("rect",{x:"2",y:"11",width:"14",height:"0.5"}),r.createElement("rect",{x:"2",y:"6",width:"14",height:"0.5"}),r.createElement("ellipse",{cx:"9",cy:"9",rx:"3",ry:"8"}))),e.name))):r.createElement("div",{className:Object(a.css)(F.noDevicesMessage)},"No devices connected"))}),r.createElement("div",{className:Object(a.css)(F.devicePreviewSwitch)},r.createElement(P.a,{checked:l,onChange:y,label:"Preview"})))}const F=a.StyleSheet.create({left:{display:"flex",alignItems:"stretch",flex:1,minWidth:0,overflow:"hidden"},loadingText:{textOverflow:"ellipsis",whiteSpace:"nowrap",padding:".5em",width:"100%",cursor:"pointer"},statusText:{border:0,outline:0,margin:0,appearance:"none",backgroundColor:"transparent",backgroundSize:16,backgroundRepeat:"no-repeat",backgroundPosition:"1em center",display:"inline-block",textOverflow:"ellipsis",whiteSpace:"nowrap",padding:".25em .5em .25em 3em",minWidth:200,width:"100%",textAlign:"left"},successText:{backgroundImage:"url(".concat(n(671),")")},errorText:{backgroundImage:"url(".concat(n(601),")"),color:Object(m.a)("error")},errorTextFatal:{backgroundImage:"url(".concat(n(672),")")},errorBorder:{borderColor:Object(m.a)("error-text")},devicesCount:{position:"absolute",top:4,right:6,height:20,minWidth:20,borderRadius:"50%",backgroundColor:Object(m.a)("text"),color:Object(m.a)("background"),opacity:.5},devicePane:{padding:"0 16px"},devicePaneItem:{margin:"0 -16px"},deviceLabel:{display:"flex",alignItems:"center",whiteSpace:"nowrap",padding:"8px 0"},deviceIcon:{height:16,width:16,marginRight:8,fill:"currentColor"},noDevicesMessage:{whiteSpace:"nowrap",margin:8},buttonLabel:{display:"none",["@media (min-width: ".concat(E.a.preview.minWidth+20,"px)")]:{display:"inline"}},buttonItem:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"},buttonItemShortcut:{userSelect:"none",cursor:"pointer",marginLeft:12},buttonItemEditorPane:{margin:"0 12px"},title:{margin:"16px 0 8px"},action:{textDecoration:"underline",cursor:"pointer",fontWeight:"bold"},devicePreviewSwitch:{display:"none",["@media (min-width: ".concat(E.a.preview.minWidth,"px)")]:{display:"block"}},menuSeparator:{margin:"6px 0",borderBottom:"1px solid ".concat(Object(m.a)("border"))}});n(234);function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class R extends r.Component{constructor(...e){super(...e),T(this,"state",{isExpanded:!1}),T(this,"_handleClick",()=>this.setState(e=>({isExpanded:!e.isExpanded}))),T(this,"_renderValue",e=>r.createElement("span",{className:Object(a.css)("object"==typeof e&&null!==e?null:"string"==typeof e?A.string:A.value)},"object"==typeof e&&null!==e?Array.isArray(e)?e.length?"[…]":"[]":Object.keys(e).length?"{…}":"{}":"string"==typeof e?'"'.concat(e,'"'):String(e)))}render(){const e=Object.keys(this.props.object);return r.createElement("div",{className:Object(a.css)(A.container)},r.createElement("div",{onClick:this._handleClick},r.createElement("span",{className:Object(a.css)(A.triangle)},this.state.isExpanded?"▼":"►"),this.props.label?r.createElement("span",{className:Object(a.css)(A.label)},this.props.label,":"):null,Array.isArray(this.props.object)?r.createElement("span",{className:Object(a.css)(A.preview)},"[",this.props.object.map((e,t,n)=>r.createElement("span",{key:t,className:Object(a.css)(A.pair)},this._renderValue(e),t!==n.length-1?",":null)),"]"):r.createElement("span",{className:Object(a.css)(A.preview)},"{",e.map((t,n)=>{const i=this.props.object[t];return r.createElement("span",{key:t,className:Object(a.css)(A.pair)},r.createElement("span",{className:Object(a.css)(A.key)},t,":"),this._renderValue(i),n!==e.length-1?",":null)}),"}")),r.createElement("div",{className:Object(a.css)(A.expanded)},this.state.isExpanded?(Array.isArray(this.props.object)?[...e,"length"]:e).map(e=>{const t=this.props.object[e];return"object"==typeof t&&null!==t&&Object.keys(t).length?r.createElement(R,{key:e,label:e,object:t}):r.createElement("div",{key:e,className:Object(a.css)(A.item)},r.createElement("span",{className:Object(a.css)(A.label,A.key)},e,":"),this._renderValue(t))}):null))}}const A=a.StyleSheet.create({container:{cursor:"default"},pair:{margin:"0 4px",verticalAlign:"middle"},preview:{margin:"0 4px",verticalAlign:1,wordBreak:"break-word",whiteSpace:"normal"},triangle:{display:"inline-block",verticalAlign:"middle",width:8,fontSize:9,opacity:.7},label:{marginLeft:6,opacity:.7},key:{marginRight:4,opacity:.7},value:{color:"#a27cca"},string:{color:"#87b121"},expanded:{marginLeft:14},item:{marginLeft:8}});function W({deviceLogs:e}){const t=e.reduce((e,t)=>{const n=e[e.length-1],a=t.payload.map(e=>{try{return JSON.parse(e)}catch(t){return e}});return n&&1===n.items.length&&n.items[0]===a[0]&&n.device===t.device.name&&n.method===t.method?n.times++:e.push({items:a,device:t.device.name,method:t.method,times:1}),e},[]);return r.createElement("div",null,t.map(({items:e,device:t,method:n,times:i},s)=>r.createElement("div",{className:Object(a.css)(z.container),key:s},r.createElement("div",{className:Object(a.css)(z.device)},t,":"),r.createElement("div",{className:Object(a.css)(z.line),key:s},e.map((e,t)=>"object"==typeof e&&null!==e?r.createElement(R,{key:t,object:e}):r.createElement("div",{key:t,className:Object(a.css)(z.item,"error"===n&&z.error,"warn"===n&&z.warning)},String(e))),i>1?r.createElement("div",{className:Object(a.css)(z.counter)},i):null))))}const z=a.StyleSheet.create({container:{display:"flex",flexDirection:"row",flexWrap:"nowrap",fontFamily:"var(--font-monospace)",fontSize:13,minHeight:16,margin:"4px 1.5em"},line:{display:"flex",flexDirection:"row",flexWrap:"wrap",whiteSpace:"pre"},item:{marginRight:8},error:{color:Object(m.a)("error")},warning:{color:Object(m.a)("warning")},device:{opacity:.5,marginRight:8},counter:{position:"relative",bottom:-1,height:16,width:16,lineHeight:"16px",fontSize:11,textAlign:"center",borderRadius:"50%",backgroundColor:Object(m.a)("soft"),color:Object(m.a)("soft-text")}});var H=n(673),B=n.n(H),V=({annotations:e,onSelectFile:t})=>{const[n,i]=r.useState(void 0);return r.createElement(r.Fragment,null,e.map(({message:s,location:o,source:l,severity:c,action:d},p)=>{var h;let m=U.infoIcon,u=U.infoColor;c>=3?(m=U.errorIcon,u=U.errorColor):c>=2?(m=U.warningIcon,u=U.warningColor):c<0&&(m=U.loadingIcon);const g=null!=o&&o.fileName?r.createElement("span",{className:Object(a.css)(U.location,u),onClick:()=>t(o.fileName)},"".concat(o.fileName," (").concat(o.startLineNumber,":").concat(o.startColumn,")")):"",b=r.createElement("div",{className:Object(a.css)(U.icon,m)}),f=s.split("\n"),v=f[0];let y;d?y=r.createElement("button",{className:Object(a.css)(U.action),onClick:d.run},d.icon?r.createElement("span",{className:Object(a.css)(U.actionIcon)},r.createElement(d.icon,null)):void 0,r.createElement("span",{className:Object(a.css)(U.actionText)},d.title)):l&&(y=r.createElement("span",{className:Object(a.css)(U.source)}," (".concat(l,")")));const E="".concat(null!==(h=null==o?void 0:o.fileName)&&void 0!==h?h:"",".").concat(v,".").concat(null!=l?l:""),x=1===e.length||n===E;return r.createElement("div",{key:p,className:Object(a.css)(U.item),onClick:()=>i(E)},r.createElement("div",{className:Object(a.css)(U.line)},b,g,v,y),x&&f.length>1?r.createElement("pre",{className:Object(a.css)(U.callstack)},B()(s.substring(v.length),"\r\n")):void 0)}))};const U=a.StyleSheet.create({item:{display:"flex",flexDirection:"column",padding:"0 1.5em"},line:{display:"flex",flexDirection:"row",alignItems:"center",border:0,margin:0,padding:"1px 0",color:Object(m.a)("text"),minHeight:30},icon:{backgroundSize:16,backgroundRepeat:"no-repeat",backgroundPosition:"center center",width:16,height:16,marginRight:"0.5em"},loadingIcon:{borderWidth:2,borderStyle:"solid",borderTopColor:Object(m.a)("text"),borderLeftColor:Object(m.a)("text"),borderBottomColor:Object(m.a)("text"),borderRightColor:"rgba(0, 0, 0, .16)",opacity:.5,borderRadius:"50%",verticalAlign:-3,animationName:[{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}],animationDuration:"1s",animationIterationCount:"infinite",animationTimingFunction:"linear"},infoIcon:{backgroundImage:"url(".concat(n(539),")")},errorIcon:{backgroundImage:"url(".concat(n(601),")")},warningIcon:{backgroundImage:"url(".concat(n(603),")")},location:{textDecoration:"underline",cursor:"pointer",marginRight:"0.5em"},infoColor:{opacity:.5},errorColor:{color:Object(m.a)("error")},warningColor:{color:Object(m.a)("warning")},source:{color:Object(m.a)("text"),opacity:.5,marginLeft:"0.5em"},action:{display:"flex",flexDirection:"row",alignItems:"center",appearance:"none",outline:0,margin:"0 0 0 0.5em",backgroundColor:Object(m.a)("content"),color:Object(m.a)("selected"),borderRadius:3,border:"1px solid ".concat(Object(m.a)("selected")),lineHeight:1,padding:"0 12px",minWidth:50,minHeight:30,":hover":{backgroundColor:Object(m.a)("selected"),color:Object(m.a)("content"),boxShadow:Object(m.c)("small")}},actionIcon:{marginRight:4},actionText:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},callstack:{color:Object(m.a)("error"),fontFamily:"var(--font-monospace)",margin:"0.5em 0px"}});function Z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class K extends r.PureComponent{constructor(...e){super(...e),Z(this,"state",{resizing:!1,initialPosition:null,initialWidth:0,initialHeight:0}),Z(this,"_handleMouseDown",e=>{if(!this._pane.current)return;const t=getComputedStyle(this._pane.current);this.setState({resizing:!0,initialPosition:{pageX:e.pageX,pageY:e.pageY},initialWidth:parseFloat(t.width||"0"),initialHeight:parseFloat(t.height||"0")})}),Z(this,"_handleMouseUp",e=>{this.state.resizing&&(e.preventDefault(),this.setState({resizing:!1,initialPosition:null,initialWidth:0,initialHeight:0}))}),Z(this,"_handleMouseMove",e=>{const{direction:t,inverted:n}=this.props,{resizing:a,initialPosition:i,initialWidth:s,initialHeight:r}=this.state;if(a&&i){var o;let a;if(e.preventDefault(),"horizontal"===t){const t=e.pageX-i.pageX;a="width: ".concat(s+(n?-t:t),"px !important;")}else{const t=i.pageY-e.pageY;a="height: ".concat(r+(n?-t:t),"px !important")}null===(o=this._pane.current)||void 0===o||o.setAttribute("style",a)}}),Z(this,"_pane",r.createRef())}componentDidMount(){document.addEventListener("mouseup",this._handleMouseUp),document.addEventListener("mousemove",this._handleMouseMove)}componentWillUnmount(){document.removeEventListener("mouseup",this._handleMouseUp),document.removeEventListener("mousemove",this._handleMouseMove)}render(){const{direction:e,inverted:t,className:n,children:i}=this.props;return r.createElement("div",{ref:this._pane,className:"".concat(Object(a.css)(Y.container)," ").concat(null!=n?n:"")},i,r.createElement("div",{className:Object(a.css)(Y.handle,"horizontal"===e?Y.horizontal:Y.vertical,"horizontal"===e?t?Y.horizontalInverted:Y.horizontalNormal:t?Y.verticalInverted:Y.verticalNormal),onMouseDown:this._handleMouseDown,onMouseUp:this._handleMouseUp}))}}const Y=a.StyleSheet.create({container:{position:"relative"},handle:{position:"absolute",zIndex:1},horizontal:{top:0,bottom:0,width:12,cursor:"col-resize"},vertical:{left:0,right:0,height:12,cursor:"row-resize"},horizontalNormal:{right:-12},horizontalInverted:{left:-12},verticalNormal:{top:-12},verticalInverted:{bottom:-12}});function $(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class J extends r.Component{constructor(...e){super(...e),$(this,"_isScrolled",!1),$(this,"_panel",r.createRef())}getSnapshotBeforeUpdate(e){return this.props.deviceLogs!==e.deviceLogs&&this._panel.current&&(this._isScrolled=this._panel.current.scrollHeight-this._panel.current.clientHeight!==this._panel.current.scrollTop),null}componentDidUpdate(e){this.props.deviceLogs!==e.deviceLogs&&this._panel.current&&!this._isScrolled&&(this._panel.current.scrollTop=this._panel.current.scrollHeight-this._panel.current.clientHeight)}render(){const{annotations:e,deviceLogs:t,onSelectFile:n,onShowErrorPanel:i,onShowDeviceLogs:s,onTogglePanels:o,onClearDeviceLogs:l,panelType:c}=this.props;return r.createElement(K,{direction:"vertical",className:Object(a.css)(q.container)},r.createElement("div",{className:Object(a.css)(q.panels)},r.createElement("div",{className:Object(a.css)(q.header)},r.createElement("button",{onClick:i,className:Object(a.css)(q.tab,"errors"!==c&&q.inactive)},"Problems"),r.createElement("button",{onClick:s,className:Object(a.css)(q.tab,"logs"!==c&&q.inactive)},"Logs"),r.createElement("div",{className:Object(a.css)(q.buttons)},"logs"===c?r.createElement("button",{onClick:l,className:Object(a.css)(q.button,q.clear)}):null,r.createElement("button",{onClick:()=>o(),className:Object(a.css)(q.button,q.close)}))),r.createElement("div",{ref:this._panel,className:Object(a.css)(q.panel)},"errors"===c?r.createElement(V,{annotations:e,onSelectFile:n}):null,"logs"===c?r.createElement(W,{deviceLogs:t}):null)))}}const q=a.StyleSheet.create({container:{height:"14em"},header:{display:"flex",flexDirection:"row",alignItems:"center",paddingTop:".75em"},tab:{display:"inline-block",appearance:"none",background:"none",border:"none",margin:0,padding:".35em 1.5em",fontSize:".9em",textTransform:"uppercase",outline:"none",opacity:1},inactive:{opacity:.5},buttons:{display:"flex",flex:1,flexDirection:"row",justifyContent:"flex-end",margin:"0 1em"},button:{height:24,width:24,border:0,outline:0,margin:"0 .5em",appearance:"none",backgroundColor:"transparent",backgroundSize:16,backgroundRepeat:"no-repeat",backgroundPosition:"center"},close:{backgroundImage:"url(".concat(n(603),")")},clear:{backgroundImage:"url(".concat(n(685),")")},panels:{backgroundColor:Object(m.a)("content"),borderColor:Object(m.a)("border"),borderWidth:"1px 0 0 0",borderStyle:"solid",height:"100%",minHeight:0},panel:{display:"flex",flexDirection:"column",minHeight:0,padding:".5em 0 .75em 0",overflow:"auto",height:"calc(100% - 2.5em)"}});var X=n(686),G=n.n(X),Q=n(484),ee=(n(88),n(67)),te=n(163),ne=n(590);function ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ie(e){return e?/^[a-z_\-\d\s]+$/i.test(e)?null:new Error("Name can only contain letters, numbers, space, hyphen (-) and underscore (_)."):new Error("Name cannot be empty.")}class se extends r.Component{constructor(...e){super(...e),ae(this,"state",{name:this.props.name||"",focused:!1}),ae(this,"_handleChangeText",e=>this.setState({name:e.target.value})),ae(this,"_handleFocus",e=>{e.target.select(),this.setState({focused:!0})}),ae(this,"_handleBlur",async()=>{var e;ie(this.state.name)||await this.props.onSubmitMetadata({name:this.state.name,description:null!==(e=this.props.description)&&void 0!==e?e:""});this.setState({focused:!1})}),ae(this,"_handleKeyDown",e=>{13!==e.keyCode&&27!==e.keyCode||ie(this.state.name)||e.target.blur()})}static getDerivedStateFromProps(e,t){return t.name===e.name||t.focused?null:{name:e.name||""}}render(){const{name:e}=this.state,{description:t,onShowEditModal:n,theme:i}=this.props,s=ie(e);return r.createElement("div",{className:Object(a.css)(oe.container)},r.createElement("div",{className:Object(a.css)(oe.titleContainer)},r.createElement("h1",{className:Object(a.css)(oe.title)},r.createElement("div",{className:Object(a.css)(oe.content)},r.createElement("div",{className:Object(a.css)(oe.field,oe.phantom)},e.replace(/\n/g,"")," "),r.createElement("input",{onFocus:this._handleFocus,onBlur:this._handleBlur,onKeyDown:this._handleKeyDown,value:e,onChange:this._handleChangeText,className:Object(a.css)(oe.field,oe.editable)}))),r.createElement(ne.a,{content:r.createElement(r.Fragment,null,r.createElement("p",{className:Object(a.css)(oe.description)},null!=t?t:ee.c),r.createElement("button",{onClick:n,className:Object(a.css)(oe.editButton)},"Edit details"))},r.createElement("button",{className:Object(a.css)(oe.icon,"light"===i?oe.infoLight:oe.infoDark)}))),this.state.focused&&s?r.createElement("div",{className:Object(a.css)(oe.validation)},s.message):null)}}var re=Object(te.a)(se);const oe=a.StyleSheet.create({container:{},titleContainer:{display:"flex",flexDirection:"row",alignItems:"flex-end"},title:{fontSize:"1.3em",lineHeight:"1.3em",fontWeight:600,margin:0,position:"relative",textOverflow:"ellipsis",overflow:"hidden"},content:{display:"flex",alignItems:"center",maxWidth:"100%"},field:{display:"inline-block",margin:0,padding:"1px 6px"},editable:{position:"absolute",appearance:"none",background:"none",outline:0,border:0,left:0,width:"100%",borderRadius:3,":hover":{boxShadow:"inset 0 0 0 1px ".concat(Object(m.a)("border"))},":focus":{boxShadow:"inset 0 0 0 1px ".concat(Object(m.a)("selected"))},":hover:focus":{boxShadow:"inset 0 0 0 1px ".concat(Object(m.a)("selected"))}},phantom:{display:"inline-block",maxWidth:"100%",pointerEvents:"none",whiteSpace:"pre",overflow:"hidden",opacity:0},validation:{position:"absolute",backgroundColor:Object(m.a)("error"),color:Object(m.a)("error-text"),fontSize:13,fontWeight:"normal",padding:"6px 12px",borderRadius:3,marginTop:8,textAlign:"left",zIndex:1e3,minWidth:100,":before":{content:'""',display:"block",position:"absolute",bottom:"100%",width:0,height:0,borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderBottom:"6px solid ".concat(Object(m.a)("error"))}},icon:{display:"block",position:"relative",appearance:"none",backgroundColor:"transparent",backgroundRepeat:"no-repeat",backgroundSize:16,backgroundPosition:"center",border:0,outline:0,margin:0,padding:0,height:24,width:24,opacity:.3,transition:".2s",":hover":{opacity:.8}},description:{margin:16},infoLight:{backgroundImage:"url(".concat(n(539),")")},infoDark:{backgroundImage:"url(".concat(n(591),")")},editButton:{width:"100%",background:"none",outline:0,border:"none",borderTop:"1px solid ".concat(Object(m.a)("border")),color:Object(m.a)("primary"),padding:"8px 16px",fontWeight:"bold",":hover":{backgroundColor:Object(m.a)("hover")}}});function le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ce=r.createContext(void 0);class de extends r.Component{constructor(...e){super(...e),le(this,"state",{isValid:!1}),le(this,"_key",0),le(this,"_inputs",[]),le(this,"_register",({validate:e,focus:t})=>{const n=this._key++;return this._inputs.push({key:n,validate:e,focus:t}),n}),le(this,"_unregister",e=>{this._inputs=this._inputs.filter(t=>t.key!==e)}),le(this,"_update",()=>this.setState({isValid:this._inputs.every(e=>!e.validate())})),le(this,"_handleSubmit",e=>{e.preventDefault();for(const e of this._inputs)if(e.validate())return void e.focus();this.props.onSubmit()})}componentDidMount(){this._update()}render(){return r.createElement(ce.Provider,{value:{register:this._register,unregister:this._unregister,update:this._update,valid:this.state.isValid}},r.createElement("form",{onSubmit:this._handleSubmit},this.props.children))}}function pe(){return(pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function he(){return(he=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function me(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ue=n(60),ge=n(456),be=n(697);function fe(){return(fe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ve({...e}){return r.createElement(be.a,fe({className:Object(a.css)(ye.input)},e))}const ye=a.StyleSheet.create({input:{outline:0,fontSize:16,borderRadius:3,padding:"12px 14px 12px 14px",lineHeight:"22px",border:"1px solid ".concat(Object(m.a)("border")),backgroundColor:Object(m.a)("content"),width:"100%",":focus":{borderColor:Object(m.a)("selected")}}});var Ee=n(507);function xe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const we=function(e){var t;function n(t){return r.createElement(ce.Consumer,null,(n={valid:!0})=>r.createElement(e,pe({disabled:!n.valid},t)))}return n.displayName="withStatus(".concat(null!==(t=e.displayName)&&void 0!==t?t:e.name,")"),n}(ue.a),Ce=function(e){var t;class n extends r.Component{constructor(...e){super(...e),me(this,"state",{initial:!0,error:null,value:this.props.value}),me(this,"_key",0),me(this,"_root",r.createRef()),me(this,"_validate",()=>this.props.validate(this.props.value)),me(this,"_focus",()=>{var e;null===(e=this._root.current)||void 0===e||e.focus(),this.state.initial&&this.setState({initial:!1,error:this.props.validate(this.props.value)})})}static getDerivedStateFromProps(e,t){const n=t.value===e.value&&t.initial;return{initial:n,error:n?null:e.validate?e.validate(e.value):null,value:e.value}}componentDidMount(){this._key=this.props.validation.register({validate:this._validate,focus:this._focus})}componentDidUpdate(e){e.value!==this.props.value&&this.props.validation.update()}componentWillUnmount(){this.props.validation.unregister(this._key)}render(){return r.createElement(e,he({ref:this._root,error:this.state.error},this.props))}}return me(n,"displayName","withValidation(".concat(null!==(t=e.displayName)&&void 0!==t?t:e.name,")")),e=>r.createElement(ce.Consumer,null,t=>r.createElement(n,he({validation:t},e)))}(Ee.a);class Se extends r.Component{constructor(...e){var t;super(...e),xe(this,"state",{name:this.props.name||"",description:null!==(t=this.props.description)&&void 0!==t?t:"",visible:this.props.visible}),xe(this,"_handleSubmit",()=>{this.props.onSubmit({name:this.state.name,description:this.state.description})}),xe(this,"_validateName",e=>e?/^[a-z_\-\d\s]+$/i.test(e)?null:new Error("Name can only contain letters, numbers, space, hyphen (-) and underscore (_)."):new Error("Name cannot be empty."))}static getDerivedStateFromProps(e,t){var n;return t.visible!==e.visible?e.visible?{name:e.name||"",description:null!==(n=e.description)&&void 0!==n?n:"",visible:e.visible}:{visible:e.visible}:null}render(){const{visible:e,title:t,onDismiss:n,isWorking:i,action:s}=this.props;return r.createElement(ge.a,{visible:e,title:t,onDismiss:n},r.createElement(de,{onSubmit:this._handleSubmit},r.createElement("h4",{className:Object(a.css)(Oe.subtitle)},"Project name"),r.createElement(Ce,{autoFocus:!0,value:this.state.name,onChange:e=>this.setState({name:e.target.value}),placeholder:"Unnamed Snack",validate:this._validateName}),r.createElement("h4",{className:Object(a.css)(Oe.subtitle)},"Description"),r.createElement(ve,{value:this.state.description,onChange:e=>this.setState({description:e.target.value}),minRows:4,placeholder:ee.c}),r.createElement("div",{className:Object(a.css)(Oe.buttons)},r.createElement(we,{type:"submit",large:!0,variant:"primary",loading:i},s))))}}const Oe=a.StyleSheet.create({subtitle:{fontSize:16,fontWeight:500,padding:0,lineHeight:"22px",margin:"16px 0 6px 0"},buttons:{margin:"20px 0 0 0"},caption:{marginTop:24,fontSize:"16px",lineHeight:"22px",textAlign:"center"},link:{cursor:"pointer",color:Object(m.a)("primary"),textDecoration:"underline"}});function je(e){const[t,n]=r.useState(new Date);r.useEffect(()=>{const e=setInterval(()=>n(new Date),1e4);return()=>clearInterval(e)},[]);const{description:i,name:s,createdAt:o,saveHistory:l,saveStatus:c,viewer:d,visibleModal:p,onShowModal:h,onHideModal:u,onSubmitMetadata:g}=e,b=l.length?l[0]:null,f=b?b.savedAt:o,v=!!l&&l.some(e=>!e.isDraft);let y;if(d){if("saving-draft"===c||"publishing"===c)y="Saving changes…";else if(f){const e=new Date(f),n=t>e?"".concat(G()(t,e,{includeSeconds:!0,addSuffix:!0})):"";y="unsaved"===c||"edited"===c?"Last saved ".concat(n):"All changes saved ".concat(n)}else y="Not saved yet";y=r.createElement(r.Fragment,null,r.createElement("span",{className:Object(a.css)(_e.statusText)},y,".")," ",v?r.createElement("button",{onClick:()=>h("previous-saves"),className:Object(a.css)(_e.textButton)},"See previous saves."):null)}else y=r.createElement(r.Fragment,null,r.createElement("a",{href:Object(Q.a)(),className:Object(a.css)(_e.textButton)},"Log in")," ",r.createElement("span",{className:Object(a.css)(_e.statusText)},"to save your changes as you work"));return r.createElement("div",{className:Object(a.css)(_e.container)},r.createElement("div",{className:Object(a.css)(_e.header)},r.createElement(re,{name:s,description:i,onSubmitMetadata:g,onShowEditModal:()=>h("edit-info")}),r.createElement("div",{className:Object(a.css)(_e.metadata)},r.createElement("p",{className:Object(a.css)(_e.status)},y),d&&"saving-draft"===c?r.createElement("div",{className:Object(a.css)(_e.spinner)}):null,d&&"saved-draft"===c||"published"===c?r.createElement("svg",{className:Object(a.css)(_e.check),width:"11px",height:"8px",viewBox:"0 0 11 8"},r.createElement("polygon",{fill:Object(m.a)("success"),points:"3.34328358 6.32835821 0.835820896 3.82089552 0 4.65671642 3.34328358 8 10.5074627 0.835820896 9.67164179 0"})):null)),r.createElement(Se,{title:"Edit Snack Details",action:"Done",visible:"edit-info"===p,onDismiss:u,onSubmit:e=>{g(e),u()},description:i,name:s}))}const _e=a.StyleSheet.create({container:{display:"flex",alignItems:"center",minWidth:0,height:"100%"},header:{minWidth:0,marginRight:16},metadata:{display:"flex",flexDirection:"row",alignItems:"center"},status:{fontSize:14,margin:"-2px 4px 0 6px",textOverflow:"ellipsis",overflow:"hidden"},textButton:{appearance:"none",background:"none",border:0,color:Object(m.a)("text"),margin:0,padding:0,textDecoration:"underline"},statusText:{opacity:.5},spinner:{borderStyle:"solid",borderTopColor:Object(m.a)("selected"),borderLeftColor:Object(m.a)("selected"),borderBottomColor:Object(m.a)("selected"),borderRightColor:"rgba(0, 0, 0, .16)",borderWidth:1,height:12,width:12,borderRadius:"50%",margin:"0 4px",animationDuration:"1s",animationName:[{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}],animationIterationCount:"infinite",animationTimingFunction:"linear"},check:{marginBottom:-4}});var ke=n(169);n(698);function Le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class De extends r.Component{constructor(...e){super(...e),Le(this,"docsearch",void 0),Le(this,"state",{isFocused:!1})}componentDidMount(){this.initDocSearch()}componentDidUpdate(e){e.sdkVersion!==this.props.sdkVersion&&this.initDocSearch()}initDocSearch(){const e=n(699);this.docsearch=e({apiKey:"2955d7b41a0accbe5b6aa2db32f3b8ac",indexName:"expo",inputSelector:"#algolia-search-box",enhancedSearchInput:!1,algoliaOptions:{facetFilters:[["version:v".concat(this.props.sdkVersion)]]},handleSelected:(e,t,n,a,i)=>{if("click"===i.selectionMethod){e.setVal("");const t=window.open(n.url,"_blank");null==t||t.focus()}}})}render(){return r.createElement("div",{key:"search".concat(this.props.sdkVersion),className:Object(a.css)(Ne.container)},r.createElement("input",{className:Object(a.css)(Ne.input),onFocus:()=>this.setState({isFocused:!0}),onBlur:()=>this.setState({isFocused:!1}),id:"algolia-search-box",type:"text",placeholder:"Search API",autoComplete:"off",spellCheck:"false",dir:"auto"}),r.createElement("div",{className:Object(a.css)(Ne.icon)},r.createElement("svg",{width:"20",height:"20",fill:"none"},r.createElement("circle",{cx:"8.75",cy:"8.333",r:"5.417",strokeWidth:"1.667"}),r.createElement("path",{d:"M12.5 12.917l4.167 4.166",strokeWidth:"1.667",strokeLinecap:"round"}))))}}const Ne=a.StyleSheet.create({container:{display:"flex",position:"relative",alignItems:"flex-end",marginRight:12,"@media (max-width: 800px)":{display:"none"}},input:{appearance:"none",boxSizing:"border-box",maxWidth:300,width:"20vw",fontSize:16,padding:"0 16px 0 40px",borderRadius:4,height:40,outline:0,backgroundColor:Object(m.a)("content"),borderStyle:"solid",borderWidth:1,borderColor:Object(m.a)("border"),":focus":{borderColor:Object(m.a)("selected")}},icon:{position:"absolute",left:0,top:0,bottom:0,width:40,opacity:.6,stroke:Object(m.a)("text"),display:"flex",justifyContent:"center",alignItems:"center"}});var Me=De,Pe=n(218),Ie=n(219),Fe=n(164);var Te=function(e){const{source:t,size:n}=e;return r.createElement("div",{className:Object(a.css)(Re.container)},t?r.createElement("img",{src:t,style:{width:n,height:n,borderRadius:n/2}}):r.createElement("svg",{width:"20",height:"20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{d:"M13.125 13.563c2.423-3.635 2.831-10.938-2.623-10.938-5.454 0-5.05 7.303-2.627 10.938-2.423 0-5.25 2.389-5.25 4.812h15.75c.004-2.423-2.827-4.813-5.25-4.813z",strokeWidth:"1.75",strokeLinecap:"round",strokeLinejoin:"round"})))};const Re=a.StyleSheet.create({container:{display:"flex",justifyContent:"center",alignItems:"center",stroke:Object(m.a)("text")}});function Ae(){return(Ae=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}class We extends r.PureComponent{render(){const{visible:e,position:t,actions:n,onHide:i,className:s,innerRef:o}=this.props;if(!e)return null;const l=n.filter(e=>e);return r.createElement("ul",{ref:o,className:C()(Object(a.css)(He.menu),s),style:t?{position:"fixed",top:Math.min(t.pageY,window.innerHeight-35-28*l.length),left:t.pageX,marginTop:-8}:{}},l.map(({label:e,handler:t,disabled:n,combo:s})=>r.createElement("li",{key:e},r.createElement("button",{disabled:n,className:Object(a.css)(He.item,n&&He.disabled),onClick:()=>{t(),i()}},r.createElement("div",null,e),s?r.createElement(M.a,{combo:s,className:Object(a.css)(He.hint)}):null))))}}var ze=r.forwardRef((e,t)=>r.createElement(We,Ae({},e,{innerRef:t})));const He=a.StyleSheet.create({menu:{zIndex:10,listStyle:"none",padding:0,borderRadius:4,borderStyle:"solid",boxShadow:Object(m.c)("popover"),minWidth:240,animationName:{from:{opacity:0},to:{opacity:1}},animationDuration:"0.083s",animationTimingfunction:"linear",backgroundColor:Object(m.a)("content"),border:"1px solid ".concat(Object(m.a)("border")),color:Object(m.a)("text")},item:{display:"flex",justifyContent:"space-between",appearance:"none",background:"none",border:0,outline:0,width:"100%",padding:"16px 12px",textAlign:"left",userSelect:"none",borderRadius:2,minHeight:56,fontSize:16,color:Object(m.a)("text"),borderBottom:"1px solid ".concat(Object(m.a)("border")),marginBottom:"-1px",":hover":{background:Object(m.a)("hover")}},disabled:{pointerEvents:"none",opacity:.5},hint:{marginLeft:24,lineHeight:"24px"}});function Be(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ve extends r.Component{constructor(...e){super(...e),Be(this,"state",{visible:!1}),Be(this,"_handleDocumentClick",e=>{this.state.visible?this._menu.current&&e.target!==this._menu.current&&!this._menu.current.contains(e.target)&&this._hideMenu():this._avatar.current&&(e.target===this._avatar.current||this._avatar.current.contains(e.target))&&this.setState(e=>({visible:!e.visible}))}),Be(this,"_handleDocumentContextMenu",()=>{this.state.visible&&this._hideMenu()}),Be(this,"_hideMenu",()=>this.setState({visible:!1})),Be(this,"_menu",r.createRef()),Be(this,"_avatar",r.createRef())}componentDidMount(){document.addEventListener("click",this._handleDocumentClick),document.addEventListener("contextmenu",this._handleDocumentContextMenu)}componentWillUnmount(){document.removeEventListener("click",this._handleDocumentClick),document.removeEventListener("contextmenu",this._handleDocumentContextMenu)}render(){const{viewer:e,legacyLogout:t}=this.props;return r.createElement("div",{className:Object(a.css)(Ze.container)},r.createElement("button",{ref:this._avatar,className:Object(a.css)(Ze.button)},r.createElement(Te,{source:null!=e&&e.picture?e.picture:null,size:26})),r.createElement(ze,{ref:this._menu,visible:this.state.visible,actions:e?[{label:"My Snacks",handler:()=>window.open("".concat("https://expo.io","/@").concat(e.username,"/snacks"))},{label:"Account Settings",handler:()=>window.open("".concat("https://expo.io","/settings"))},...t?[{label:"Log out",handler:t}]:[]]:[{label:"Log in to Expo",handler:()=>window.location.href=Object(Q.a)()}],onHide:this._hideMenu,className:Object(a.css)(Ze.menu)}))}}var Ue=Object(Fe.a)(Ve);const Ze=a.StyleSheet.create({container:{marginRight:16},menu:{position:"absolute",margin:"4px 0",right:16,top:"100%"},button:{appearance:"none",background:"transparent",padding:0,margin:0,border:0,outline:0,height:40,width:40,borderRadius:2,textDecoration:"none",display:"flex",justifyContent:"center",alignItems:"center",":hover":{backgroundColor:Object(m.a)("hover")}}});function Ke(e){const[t]=Object(ke.a)(),{name:i,description:s,createdAt:o,saveHistory:l,saveStatus:c,sdkVersion:d,viewer:p,isDownloading:h,isResolving:m,visibleModal:u,onSubmitMetadata:g,onShowModal:b,onHideModal:f,onDownloadCode:v,onPublishAsync:y}=e,{theme:E}=t,x="publishing"===c,w="published"===c;return r.createElement(Pe.a,null,r.createElement(Ie.a,null,r.createElement("img",{src:n("dark"===E?599:744),alt:"Snack",className:Object(a.css)(Ye.logo)}),r.createElement(je,{name:i,description:s,createdAt:o,saveHistory:l,saveStatus:c,viewer:p,visibleModal:u,onSubmitMetadata:g,onShowModal:b,onHideModal:f})),r.createElement("div",{className:Object(a.css)(Ye.buttons)},r.createElement(Me,{sdkVersion:d}),r.createElement(ue.a,{variant:"secondary",onClick:()=>y(),disabled:x||m||w,loading:x,className:Object(a.css)(Ye.saveButton)},x?"Saving…":w?"Saved":"Save"),r.createElement(L.a,{responsive:!0,title:"Run on device",onClick:()=>b("device-instructions")},r.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20"},r.createElement("path",{d:"M8.333 7.083v5.667l4.534-2.833-4.534-2.834z",stroke:"none"}),r.createElement("path",{d:"M8.333 10H2.5",strokeWidth:"1.25",strokeLinecap:"round"}),r.createElement("path",{d:"M5.444 11.889v3.778c0 1.043.846 1.889 1.89 1.889h6.61a1.889 1.889 0 001.89-1.89V4.334a1.889 1.889 0 00-1.89-1.889h-6.61a1.889 1.889 0 00-1.89 1.89V8.11",fill:"none",strokeWidth:"1.667"}),r.createElement("rect",{x:"8.333",y:"1.667",width:"5",height:"2.5",rx:".833",stroke:"none"}))),r.createElement(L.a,{responsive:!0,title:"Download as zip",onClick:v,disabled:h||x},r.createElement("svg",{width:"20",height:"20"},r.createElement("path",{d:"M14.167 10H5.833L10 16.667 14.167 10z"}),r.createElement("path",{d:"M2.5 18.333h15M10 10V1.667",strokeWidth:"2",strokeLinecap:"round"}))),r.createElement(L.a,{responsive:!0,title:"Show embed code",onClick:()=>b("embed")},r.createElement("svg",{width:"20px",height:"18px",viewBox:"0 0 20 18",fill:"none"},r.createElement("path",{d:"M13.333 15l5-5-5-5M6.667 5l-5 5 5 5",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}))),r.createElement(Ue,null)))}const Ye=a.StyleSheet.create({logo:{width:24,height:24,marginLeft:16,marginRight:16},buttons:{display:"flex",flexDirection:"row",alignItems:"center",position:"relative",zIndex:5},saveButton:{height:40,fontWeight:600,minWidth:80,fontSize:"16px",marginRight:16}});var $e=n(546),Je=n.n($e),qe=n(166),Xe=n(538);function Ge(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Qe=e=>e.target.select();class et extends r.PureComponent{constructor(e){super(e),Ge(this,"state",void 0),Ge(this,"_reinitialize",()=>{if("ExpoSnack"in window){const e=document.querySelector("[data-snack-id]");window.ExpoSnack.remove(e),window.ExpoSnack.append(e)}}),Ge(this,"_maybeInsertScript",()=>{if(document.querySelectorAll('script[src="'.concat(this.state.url,'"]')).length)return void this._reinitialize();const e=document.createElement("script");e.async=!0,e.type="text/javascript",e.src=this.state.url,document.body&&document.body.appendChild(e)}),Ge(this,"_handleCopy",()=>{this.setState({copied:!0}),setTimeout(()=>this.setState({copied:!1}),1e3)}),Ge(this,"_handleTogglePreview",()=>this.setState(e=>({preview:!e.preview}))),Ge(this,"_handleToggleTheme",()=>this.setState(e=>({theme:"light"===e.theme?"dark":"light"}))),Ge(this,"_handleChangePlatform",e=>this.setState({platform:e})),this.state={platform:"web",preview:!0,theme:this.props.theme||"light",copied:!1,url:"".concat(window.location.origin,"/embed.js")}}componentDidMount(){this._maybeInsertScript()}componentDidUpdate(e,t){t.preview===this.state.preview&&t.platform===this.state.platform&&t.theme===this.state.theme||requestAnimationFrame(this._reinitialize)}render(){var e;const{platform:t,preview:n,theme:i,copied:s,url:o}=this.state,l='<div data-snack-id="'.concat(null!==(e=this.props.id)&&void 0!==e?e:"",'" data-snack-platform="').concat(t,'" data-snack-preview="').concat(String(n),'" data-snack-theme="').concat(i,'" style="overflow:hidden;background:').concat(Object(m.a)("background",i),";border:1px solid ").concat(Object(m.a)("border"),';border-radius:4px;height:505px;width:100%"></div>'),c="".concat(l,'\n<script async src="').concat(o,'"><\/script>');return r.createElement("div",{className:Object(a.css)(nt.container)},r.createElement(qe.a,{visible:s},"Copied to clipboard!"),r.createElement("div",{className:Object(a.css)(nt.section)},r.createElement("div",{className:Object(a.css)(nt.header)},r.createElement("h3",{className:Object(a.css)(nt.title)},"Embed Preview"),r.createElement("a",{href:E.a.links.authorDocs,target:"blank"},"Learn more about what's possible")),r.createElement("div",{className:Object(a.css)(nt.row,nt.options)},r.createElement(Xe.a,{options:this.props.platformOptions,value:t,onValueChange:this._handleChangePlatform,className:Object(a.css)(nt.last)}),r.createElement(P.a,{checked:n,label:"Preview",onChange:this._handleTogglePreview}),r.createElement(P.a,{checked:"light"!==i,label:"Dark theme",onChange:this._handleToggleTheme})),r.createElement("div",{dangerouslySetInnerHTML:{__html:l}})),r.createElement("div",{className:Object(a.css)(nt.section)},r.createElement("h3",{className:Object(a.css)(nt.header)},"Embed Code"),r.createElement("div",{className:Object(a.css)(nt.inputContainer)},r.createElement("input",{readOnly:!0,className:Object(a.css)(nt.code),onClick:Qe,value:c}),r.createElement(Je.a,{text:c,onCopy:this._handleCopy},r.createElement(ue.a,{variant:"primary",className:Object(a.css)(nt.copyButton)},"Copy to clipboard")))))}}var tt=Object(te.a)(et);const nt=a.StyleSheet.create({container:{width:780,textAlign:"left"},header:{display:"flex",flexDirection:"row",alignItems:"center"},title:{margin:".5em 0",display:"inline",fontWeight:500,flex:1},options:{color:Object(m.a)("text"),marginBottom:".5em"},last:{marginRight:0},row:{display:"flex",flexDirection:"row",alignItems:"center"},section:{":not(:last-of-type)":{paddingBottom:"1.5em"}},code:{fontFamily:"var(--font-monospace)",padding:"1em",width:"100%",outline:0,border:"1px solid ".concat(Object(m.a)("border")),borderRadius:3,color:Object(m.a)("text"),backgroundColor:Object(m.a)("background")},inputContainer:{position:"relative"},copyButton:{position:"absolute",right:0}});var at=n(745),it=n.n(at),st=n(71),rt=n(619);function ot(){return(ot=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}class lt extends r.PureComponent{render(){const{innerRef:e,...t}=this.props;return r.createElement("button",ot({},t,{className:Object(a.css)(dt.button),ref:e}),r.createElement("svg",{className:Object(a.css)(dt.icon),viewBox:"0 0 16 16"},this.props.children))}}var ct=r.forwardRef((e,t)=>r.createElement(lt,ot({},e,{innerRef:t})));const dt=a.StyleSheet.create({button:{appearance:"none",background:"transparent",border:0,margin:0,outline:0},icon:{fill:"currentColor",height:16,width:16,verticalAlign:-3}});function pt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ht extends r.PureComponent{constructor(...e){super(...e),pt(this,"state",{menu:null}),pt(this,"_hideContextMenu",()=>this.setState({menu:null})),pt(this,"_showContextMenu",e=>{const{bottom:t,right:n}=e.currentTarget.getBoundingClientRect();this.setState({menu:{pageX:n-8,pageY:t-8}})}),pt(this,"_handleDocumentClick",e=>{this.state.menu&&this._button.current&&e.target!==this._button.current&&!this._button.current.contains(e.target)&&this._hideContextMenu()}),pt(this,"_toggleContextMenu",e=>{this.state.menu?this._hideContextMenu():this._showContextMenu(e)}),pt(this,"_button",r.createRef())}componentDidMount(){document.addEventListener("click",this._handleDocumentClick),document.addEventListener("contextmenu",this._hideContextMenu)}componentWillUnmount(){document.removeEventListener("click",this._handleDocumentClick),document.removeEventListener("contextmenu",this._hideContextMenu)}render(){const e="published"===this.props.saveStatus||"saved-draft"===this.props.saveStatus;return r.createElement("div",null,r.createElement(ct,{ref:this._button,onClick:this._toggleContextMenu},r.createElement("g",{fillOpacity:"0.7"},r.createElement("circle",{cy:"3",cx:"8",r:"1.5"}),r.createElement("circle",{cy:"8",cx:"8",r:"1.5"}),r.createElement("circle",{cy:"13",cx:"8",r:"1.5"}))),r.createElement(ze,{visible:Boolean(this.state.menu),position:this.state.menu,actions:[{label:"Import files",handler:this.props.onImportFilesClick},{label:"Import git repository",handler:this.props.onImportRepoClick},{label:"Export project",handler:this.props.onExportClick,disabled:!(e&&this.props.hasSnackId)}],onHide:this._hideContextMenu}))}}const mt=[/^\./,/\.(jks|keystore)$/,/^(android|ios)$/,/^coverage$/,/^(js|ts)config\.json$/,/^flow-typed$/,/^node_modules$/,/^npm-debug\.log$/,/^npm-error\.log$/,/^package-lock\.json$/,/^yarn-debug\.log$/,/^yarn-error\.log$/,/^yarn\.lock$/,/^__tests__$/,/^__integration-tests__$/,/^__mocks__$/,/~$/],ut=[/^\.eslintrc(\.json)?$/],gt=async(e,t,n)=>{if(!mt.some(t=>t.test(e.name))||ut.some(t=>t.test(e.name)))if(e.isFile){const a=await new Promise((t,n)=>e.file(t,n));t.push({path:n,file:a})}else if(e.isDirectory){const a=e.createReader(),i=await new Promise((e,t)=>a.readEntries(e,t));await Promise.all(i.map(async e=>gt(e,t,"".concat(n,"/").concat(e.name))))}};function bt({dataTransfer:e},t){return!!e&&(e.types instanceof DOMStringList?e.types.contains(t):e.types.indexOf(t)>-1)}var ft=n(584);function vt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class yt extends r.PureComponent{constructor(...e){super(...e),vt(this,"state",{isImportModalShown:!1,isDragging:!1,isImporting:!1,itemsToImport:[],itemsErrored:[],importProgress:0,importTotal:0}),vt(this,"_handleDragOver",e=>{if(bt(e,"Files")){if(e.preventDefault(),this.state.isImportModalShown)return!0;this.state.isDragging||this.setState({isDragging:!0}),clearTimeout(this._dragTimer),this._dragTimer=setTimeout(this._handleDragEnd,300)}}),vt(this,"_handleDragEnd",()=>{this.state.isDragging&&this.setState({isDragging:!1})}),vt(this,"_handleDrop",e=>{if(bt(e,"Files")&&e.dataTransfer&&(e.dataTransfer.items||e.dataTransfer.files)){const t=e.dataTransfer;e.preventDefault();let n=[];n=t.items?Array.from(t.items).map(e=>{const n=e.webkitGetAsEntry(),a=Array.from(t.files).find(e=>e.name===n.name);return n.isFile&&a?a:n}):Array.from(t.files),this._handleSelectFilesForImport(n)}}),vt(this,"_dragTimer",void 0),vt(this,"_showImportModal",()=>this.setState({isImportModalShown:!0})),vt(this,"_hideImportModal",()=>this.setState({isImportModalShown:!1,itemsToImport:[]})),vt(this,"_handleSelectFilesForImport",e=>this.setState(t=>({isImportModalShown:!0,itemsToImport:[...t.itemsToImport,...e],itemsErrored:[]}))),vt(this,"_handleImportClick",async()=>{this.setState({isImporting:!0,isImportModalShown:!1,importProgress:0});const e=this.props.entries.map(e=>e.item.path),t={},{itemsToImport:n}=this.state;n.forEach(n=>{n.isDirectory&&(t[n.name]=Object(d.c)(e,n.name))});const a=await async function(e,t){const n=[];return await Promise.all(e.map(e=>{const a=t[e.name]||e.name;return e instanceof File?void n.push({file:e,path:a}):gt(e,n,a)})),n}(n,t);this.setState({importTotal:a.length}),await Promise.all(a.map(async({file:e,path:t})=>{try{const n=!Object(d.d)(t)||Object(d.e)(t)?await new Promise((n,a)=>{const i=new FileReader;i.onload=e=>n({item:{path:t,type:"file",content:e.target?e.target.result:""},state:{}}),i.onerror=e=>a(e),i.readAsText(e)}):await this.props.uploadFileAsync(e).then(e=>({item:{path:t,type:"file",uri:e,asset:!0},state:{}}));if(!this.state.itemsToImport.length)return;this.props.onImportFile(n)}catch(t){console.error(t),this.setState(n=>({itemsErrored:[...n.itemsErrored,{item:e,error:t}]}))}finally{this.setState(e=>({importProgress:e.importProgress+1}))}})),this.setState({itemsToImport:[]})}),vt(this,"_handleFilesChange",e=>this._handleSelectFilesForImport(e.target.files)),vt(this,"_handleRemoveFileImport",e=>this.setState(t=>({itemsToImport:t.itemsToImport.filter(t=>t!==e)}))),vt(this,"_handleProgressDismiss",()=>{this.setState({itemsToImport:[],itemsErrored:[],importProgress:0,isImporting:!1})})}componentDidMount(){document.addEventListener("dragover",this._handleDragOver),document.addEventListener("drop",this._handleDrop)}render(){const{isImporting:e,importProgress:t,itemsToImport:n,itemsErrored:i,isDragging:s,isImportModalShown:o,importTotal:l}=this.state,c=t-i.length;return r.createElement("div",{className:this.props.className},this.props.render({onImportStart:this._showImportModal}),e?r.createElement("div",{className:Object(a.css)(Et.importProgress)},r.createElement("div",{className:Object(a.css)(Et.importProgressHeader)},r.createElement("h4",{className:Object(a.css)(Et.importProgressLabel)},0===l?"Reading files…":t===l?"".concat(c," file").concat(1===c?"":"s"," imported").concat(i.length?", ".concat(i.length," failed to import"):" successfully"):"Importing files (".concat(t+1,"/").concat(l,")")),r.createElement("button",{onClick:this._handleProgressDismiss,className:Object(a.css)(Et.importProgressButton)},t===l?"Dismiss":"Cancel")),l?r.createElement("progress",{className:Object(a.css)(Et.importProgressBar),value:t/l*100,max:100}):null):null,r.createElement(ft.a,{visible:s},r.createElement("div",{className:Object(a.css)(Et.dropzoneLarge)},r.createElement("h2",null,"Drop anywhere to import"),r.createElement("p",null,"You'll be able to adjust your selection before importing them into your project"))),r.createElement(ge.a,{visible:o,onDismiss:this._hideImportModal,title:"Import files"},r.createElement("div",{className:Object(a.css)(Et.dropzoneSmall)},n.length?r.createElement("ul",{className:Object(a.css)(Et.fileList)},n.map((e,t)=>r.createElement("li",{className:Object(a.css)(Et.fileEntry),key:t},r.createElement("span",{className:Object(a.css)(Et.fileEntryName)},e.isDirectory?"".concat(e.name,"/"):e.name),r.createElement("span",{className:Object(a.css)(Et.fileEntrySize)},"number"==typeof e.size?"".concat((e.size/1024).toFixed(2),"kb"):""),r.createElement("button",{onClick:()=>this._handleRemoveFileImport(e),className:Object(a.css)(Et.fileEntryClose)},"×")))):r.createElement("div",{className:Object(a.css)(Et.dropzonePlaceholder)},"Drop your files or",r.createElement("label",{className:Object(a.css)(Et.fileInputLabel)},"browse",r.createElement("input",{multiple:!0,type:"file",onChange:this._handleFilesChange,className:Object(a.css)(Et.fileInput)})))),r.createElement(ue.a,{large:!0,variant:"primary",onClick:this._handleImportClick,disabled:!n.length},n.length?"Import ".concat(n.length," item").concat(n.length>=2?"s":""):"Import")))}}const Et=a.StyleSheet.create({dropzoneLarge:{textAlign:"center",padding:48,border:"2px dashed ".concat(Object(m.a)("border")),borderRadius:4},dropzoneSmall:{border:"1px dashed ".concat(Object(m.a)("border")),backgroundColor:Object(m.a)("background"),borderRadius:3,height:"12em",marginBottom:8},dropzonePlaceholder:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},fileInputLabel:{margin:0,paddingLeft:4,color:Object(m.a)("selected"),fontWeight:"normal",cursor:"pointer",":hover":{textDecoration:"underline"}},fileInput:{display:"none"},fileList:{listStyle:"none",textAlign:"left",padding:0,margin:0,height:"100%",width:"100%",overflow:"auto"},fileEntry:{display:"flex",borderBottom:"1px solid ".concat(Object(m.a)("border")),alignItems:"center"},fileEntrySize:{flex:1,opacity:.5,margin:8},fileEntryName:{margin:8,maxWidth:"15em",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},fileEntryClose:{padding:"4px 12px",margin:"0 4px",fontSize:18,background:"none",border:"none",appearance:"none"},importProgress:{position:"fixed",zIndex:10,left:"1em",bottom:"4em",width:"24em",padding:"8px 16px",borderRadius:3,backgroundColor:Object(m.a)("content"),border:"1px solid ".concat(Object(m.a)("border")),boxShadow:Object(m.c)("popover")},importProgressHeader:{display:"flex",flexDirection:"row",alignItems:"center",margin:"4px 0"},importProgressLabel:{flex:1,fontSize:"1em",fontWeight:500,margin:0},importProgressButton:{appearance:"none",background:"none",border:0,color:Object(m.a)("primary")},importProgressBar:{appearance:"none",width:"100%",margin:"8px 0",height:6,borderRadius:3,overflow:"hidden","::-webkit-progress-bar":{backgroundColor:Object(m.a)("content")},"::-webkit-progress-value":{backgroundColor:Object(m.a)("primary")},"::-moz-progress-bar":{backgroundColor:Object(m.a)("content")},"::-moz-progress-value":{backgroundColor:Object(m.a)("primary")}}});var xt=n(217),wt=n(583),Ct=n(209),St=n.n(Ct),Ot=n(498);function jt(){return(jt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function _t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class kt extends r.PureComponent{constructor(...e){super(...e),_t(this,"_getParentPath",e=>e.includes("/")?e.replace(/\/[^/]+$/,""):null),_t(this,"_isDirectChild",e=>{if(this.props.entry&&this.props.entry.item.path===e)return!0;const t=this._getParentPath(e);return this.props.entry&&t?this.props.entry.item.path===t:null==this.props.entry&&null==t}),_t(this,"_handleDragLeave",e=>{e.currentTarget.style.backgroundColor=null,clearTimeout(this._dragTimer),this._dragTimer=null}),_t(this,"_handleDragOver",e=>{const t=Nt;!bt(e,"application/json")||this.props.entry&&"folder"!==this.props.entry.item.type||!t||"file"!==t.item.type&&"folder"!==t.item.type||(e.stopPropagation(),this._isDirectChild(t.item.path)||(e.preventDefault(),e.currentTarget.style.backgroundColor="dark"===this.props.theme?"rgba(255, 255, 255, .1)":"rgba(0, 0, 0, .1)",this._dragTimer||(this._dragTimer=setTimeout(()=>{this.props.entry&&!this.props.entry.state.isExpanded&&this.props.onExpand&&this.props.onExpand(this.props.entry.item.path)},500))))}),_t(this,"_dragTimer",void 0),_t(this,"_handleDrop",e=>{if(e.currentTarget.style.backgroundColor=null,bt(e,"application/json")&&(!this.props.entry||"folder"===this.props.entry.item.type)){e.preventDefault(),e.stopPropagation();try{const t=e.dataTransfer.getData("application/json"),n=JSON.parse(t);if("file"!==n.item.type&&"folder"!==n.item.type||this._isDirectChild(n.item.path))return;const a=n.item.path.split("/").pop();this.props.onRename(n.item.path,Object(d.c)(this.props.rest.map(e=>e.item.path),this.props.entry?this.props.entry.item.path+"/"+a:a))}catch(e){}}}),_t(this,"_container",r.createRef())}componentDidMount(){const e=this._container.current;e&&(e.addEventListener("dragover",this._handleDragOver),e.addEventListener("dragleave",this._handleDragLeave),e.addEventListener("dragend",this._handleDragLeave),e.addEventListener("drop",this._handleDrop))}componentWillUnmount(){const e=this._container.current;e&&(e.removeEventListener("dragover",this._handleDragOver),e.removeEventListener("dragleave",this._handleDragLeave),e.removeEventListener("dragend",this._handleDragLeave),e.removeEventListener("drop",this._handleDrop))}render(){const{entry:e,rest:t,onExpand:n,onRename:a,theme:i,...s}=this.props;return r.createElement("div",jt({},s,{ref:this._container}))}}var Lt=Object(te.a)(kt);function Dt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let Nt;class Mt extends r.Component{constructor(...e){super(...e),Dt(this,"state",{menu:null,isHovered:!1}),Dt(this,"_handleClick",e=>{"INPUT"!==e.target.tagName&&this.props.onOpen(this.props.entry.item.path)}),Dt(this,"_handleMouseEnter",()=>this.setState({isHovered:!0})),Dt(this,"_handleMouseLeave",()=>this.setState({isHovered:!1})),Dt(this,"_handleMouseDown",()=>this._click=!0),Dt(this,"_handleFocus",()=>{this._click?this._click=!1:this.props.onFocus(this.props.entry.item.path)}),Dt(this,"_handleKeyDown",e=>{if("INPUT"===e.target.tagName)return;const t=this.props.actions.filter(t=>!(null==t||!t.combo)&&Object(Ot.c)(e,t.combo));t.length&&(e.preventDefault(),t.forEach(e=>null==e?void 0:e.handler()))}),Dt(this,"_hideContextMenu",()=>this.setState({menu:null})),Dt(this,"_showContextMenu",e=>{this.setState({menu:{pageX:e.pageX,pageY:e.pageY}})}),Dt(this,"_handleDocumentClick",e=>{this.state.menu?this._menu.current&&e.target!==this._menu.current&&!this._menu.current.contains(e.target)&&this._hideContextMenu():this._more.current&&(e.target===this._more.current||this._more.current.contains(e.target))&&(this.state.menu?this._hideContextMenu():this._showContextMenu(e))}),Dt(this,"_handleDocumentContextMenu",e=>{var t;e.target===this._item.current||null!==(t=this._item.current)&&void 0!==t&&t.contains(e.target)?(e.preventDefault(),this._showContextMenu(e)):this.state.menu&&this._hideContextMenu()}),Dt(this,"_handleDragStart",e=>{e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("application/json",JSON.stringify(this.props.entry)),Nt=this.props.entry}),Dt(this,"_handleDragEnd",()=>{Nt=null}),Dt(this,"_click",!1),Dt(this,"_item",r.createRef()),Dt(this,"_more",r.createRef()),Dt(this,"_menu",r.createRef())}componentDidMount(){document.addEventListener("click",this._handleDocumentClick),document.addEventListener("contextmenu",this._handleDocumentContextMenu)}componentWillUnmount(){document.removeEventListener("click",this._handleDocumentClick),document.removeEventListener("contextmenu",this._handleDocumentContextMenu)}render(){var e,t;const{entry:n,rest:i,draggable:s,onRename:o,onExpand:l,theme:c,actions:d}=this.props,{menu:p,isHovered:h}=this.state;return r.createElement(Lt,{entry:n,rest:i,onRename:o,onExpand:l},r.createElement("div",{ref:this._item,draggable:s,onDragStart:this._handleDragStart,onDragEnd:this._handleDragEnd,tabIndex:0,className:Object(a.css)(Pt.entry),onClick:this._handleClick,onMouseEnter:this._handleMouseEnter,onMouseLeave:this._handleMouseLeave,onMouseDown:this._handleMouseDown,onFocus:this._handleFocus,onKeyDown:this._handleKeyDown},this.props.renderItem()),r.createElement("div",{className:Object(a.css)(Pt.highlight,"dark"===c?Pt.highlightDark:Pt.highlightLight,n.state.isSelected?Pt.highlightActive:null)}),r.createElement(ze,{ref:this._menu,visible:Boolean(p),position:p,actions:d,onHide:this._hideContextMenu}),r.createElement("button",{ref:this._more,tabIndex:-1,className:Object(a.css)(Pt.more,h||p?Pt.moreVisible:Pt.moreInvisible)},this.props.renderMenuIcon()),null===(e=(t=this.props).renderTree)||void 0===e?void 0:e.call(t))}}Dt(Mt,"defaultProps",{draggable:!0});const Pt=a.StyleSheet.create({entry:{position:"relative",display:"inline-block",outline:0,padding:"4px 16px",width:"100%",cursor:"pointer",zIndex:1,whiteSpace:"nowrap"},highlight:{content:'""',display:"inline-block",height:30,position:"absolute",left:0,right:0,opacity:0,zIndex:1,pointerEvents:"none"},highlightLight:{backgroundColor:"rgba(0, 0, 0, .04)"},highlightDark:{backgroundColor:"rgba(255, 255, 255, .04)"},highlightActive:{opacity:1},more:{position:"absolute",left:-8,border:0,outline:0,background:"none",height:30,zIndex:2,padding:"7px 12px",textAlign:"right",":hover":{opacity:1}},moreInvisible:{opacity:0},moreVisible:{opacity:1},icon:{fill:"currentColor",height:16,width:16}});function It({entry:e}){let t;return e.state.isLoading?r.createElement("div",{className:Object(a.css)(Ft.spinner)}):(t=Object(d.f)(e.item.path)?r.createElement("g",null,r.createElement("path",{d:"M7.46487122,14 C7.80521143,13.4116533 8,12.7285743 8,12 C8,9.790861 6.209139,8 4,8 C3.65470043,8 3.31961992,8.043753 3,8.12601749 L3,2 L13,2 L13,14 L7.46487122,14 Z M9,2 L13,6 L13,2 L9,2 Z M9,6 L9,2 L8,2 L8,7 L13,7 L13,6 L9,6 Z"}),r.createElement("circle",{cx:"4",cy:"12",r:"3"})):Object(d.j)(e.item.path)?r.createElement("path",{d:"M2,5.09257608 L7.47329684,8.31213064 L7.47329684,14.7092088 L2,11.5325867 L2,5.09257608 Z M2.49245524,4.22207437 L7.97432798,1 L13.506361,4.2238509 L7.92838937,7.41965108 L2.49245524,4.22207437 Z M14,5.09352708 L14,11.5325867 L8.47329684,14.7128733 L8.47329684,8.25995389 L14,5.09352708 Z"}):"folder"===e.item.type?e.state.isExpanded?r.createElement("g",null,r.createElement("path",{d:"M7.5,5 L2,5 L2,13 L7.75,13 L14,13 L14,4 L15,4 L15,14 L1,14 L1,4 L6.5,4 L5.5,5 L7.5,5 L7.5,4.5 L7.5,5 Z M14,4 L14,3 L7.5,3 L7.5,3.5 L7.5,3 L7,3.5 L7,2 L15,2 L15,4 L14,4 Z M6.5,4 L5,4 L7,2 L7,3.5 L6.5,4 Z"}),r.createElement("polygon",{points:"0 7 13 7 14 14 1 14"})):r.createElement("path",{d:"M7.25,4 L7.5,4 L7.5,3 L7,3.5 L7,2 L15,2 L15,4 L7.25,4 Z M6.75,4 L5,4 L7,2 L7,3.5 L6.5,4 L6.75,4 Z M1,4 L15,4 L15,14 L1,14 L1,4 Z M7.5,3 L7.5,4 L14,4 L14,3 L7.5,3 Z"}):Object(d.g)(e.item.path)?r.createElement("g",null,r.createElement("circle",{cx:"5",cy:"5",r:"1"}),r.createElement("polygon",{points:"5.71428571 8.41176471 8 11.2352941 10.8571429 7 14 13 2 13"}),r.createElement("path",{d:"M3,3 L3,13 L13,13 L13,3 L3,3 Z M3,2 L13,2 C13.5522847,2 14,2.44771525 14,3 L14,13 C14,13.5522847 13.5522847,14 13,14 L3,14 C2.44771525,14 2,13.5522847 2,13 L2,3 C2,2.44771525 2.44771525,2 3,2 Z"})):r.createElement("path",{d:"M3,2 L13,2 L13,14 L3,14 L3,2 Z M9,2 L13,6 L13,2 L9,2 Z M9,6 L9,2 L8,2 L8,7 L13,7 L13,6 L9,6 Z"}),r.createElement("svg",{className:Object(a.css)(Ft.icon,Object(d.m)(e.item.path)?Ft.test:void 0,e.state.isError?Ft.error:void 0),viewBox:"0 0 16 16"},t))}const Ft=a.StyleSheet.create({icon:{height:16,width:16,fill:"currentColor",verticalAlign:"middle",opacity:.7},error:{fill:Object(m.a)("error")},test:{color:Object(m.a)("soft")},spinner:{display:"inline-block",verticalAlign:"middle",borderStyle:"solid",borderTopColor:"currentColor",borderLeftColor:"currentColor",borderBottomColor:"currentColor",borderRightColor:"rgba(0, 0, 0, .16)",borderWidth:1,height:12,width:12,borderRadius:"50%",margin:"2px 2px",animationDuration:"1s",animationName:[{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}],animationIterationCount:"infinite",animationTimingFunction:"linear"}});function Tt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Rt=e=>e.replace(/(\.[^.]+$)/,(e,t)=>".js"===t?".tsx":".js");class At extends r.Component{constructor(e){var t;super(e),Tt(this,"state",void 0),Tt(this,"_handleToggleExpand",()=>this.props.onExpand(this.props.entry.item.path,!this.props.entry.state.isExpanded)),Tt(this,"_handleToggleRename",()=>{this.state.isRenaming&&!this.state.error&&this._handleNameChange(this.state.name),this.setState((e,t)=>{var n;return e.isRenaming?{isRenaming:!1,name:"",error:null}:{isRenaming:!0,name:null!==(n=t.entry.item.path.split("/").pop())&&void 0!==n?n:"",error:null}})}),Tt(this,"_handleDelete",()=>this.props.onDelete(this.props.entry.item.path)),Tt(this,"_handleNameChange",e=>{const{entry:t}=this.props;if(e&&(e!==t.item.path.split("/").pop()||t.state.isCreating)){const n=t.item.path.replace(/[^/]+$/,e);this.props.onRename(t.item.path,n)}}),Tt(this,"_handleInputChange",e=>{const t=e.target.value;this.setState({name:t,error:this._validateName(t)})}),Tt(this,"_validateName",e=>{if(e===this.props.entry.item.path.split("/").pop())return null;const t=["\0","\\",":","*","?",'"',"<",">","|"].filter(t=>e.includes(t));if(t.length)return new Error("".concat(1===t.length?"".concat(t[0]," is"):"".concat(t.join(", ")," are")," not allowed"));return this.props.getAdjacentEntries().some(t=>{var n;return(null!==(n=t.item.path.split("/").pop())&&void 0!==n?n:"").toLowerCase()===e.toLowerCase()})?new Error("Another entry already exists with same name"):Object(d.f)(e)?new Error("Cannot name a new file as ".concat(e)):null}),Tt(this,"_handleInputFocus",e=>{const t=e.target;t instanceof HTMLInputElement&&t.select()}),Tt(this,"_handleInputBlur",()=>{this.state.error||this._handleNameChange(this.state.name),this.setState({isRenaming:!1,name:"",error:null})}),Tt(this,"_handleInputKeyUp",e=>{switch(e.keyCode){case Ot.a.Enter:this._handleToggleRename();break;case Ot.a.Escape:this._handleInputBlur()}}),Tt(this,"_handleCreateFile",()=>this.props.onCreateFile(this.props.entry.item.path)),Tt(this,"_handleCreateFolder",()=>this.props.onCreateFolder(this.props.entry.item.path)),Tt(this,"_handleCopy",()=>this.props.onCopy(this.props.entry.item.path)),Tt(this,"_handlePaste",()=>{const{entry:e,clipboard:t,onPaste:n,onClearClipboard:a}=this.props;t.forEach(t=>n(e.item.path,t)),a()}),Tt(this,"_handleDuplicate",()=>{const{entry:e,onPaste:t}=this.props;t(e.item.path.includes("/")?"folder"===e.item.type?Object(d.b)(e.item.path):e.item.path:void 0,e)}),Tt(this,"_handleToggleTSExt",()=>{const e=this.props.entry.item.path;this.props.onRename(e,Rt(e))}),Tt(this,"_getActions",()=>[{label:"New file",handler:this._handleCreateFile},{label:"New folder",handler:this._handleCreateFolder},"folder"===this.props.entry.item.type?{label:"folder"===this.props.entry.item.type&&this.props.entry.state.isExpanded?"Collapse":"Expand",handler:this._handleToggleExpand,combo:[Ot.a.Enter]}:void 0,this.props.clipboard.length?{label:"Paste",handler:this._handlePaste,combo:[Ot.a.Meta,Ot.a.V]}:this.props.entry.item.virtual?void 0:{label:"Copy",handler:this._handleCopy,combo:[Ot.a.Meta,Ot.a.C]},this.props.entry.item.virtual?void 0:{label:"Duplicate",handler:this._handleDuplicate,combo:[Ot.a.Meta,Ot.a.D]},Object(d.f)(this.props.entry.item.path)?{label:"Rename to ".concat(Rt(this.props.entry.item.path)),handler:this._handleToggleTSExt}:void 0,...Object(d.f)(this.props.entry.item.path)||this.props.entry.item.virtual?[]:[{label:"Rename",handler:this._handleToggleRename,combo:[Ot.a.F2]},{label:"Delete",handler:this._handleDelete,combo:[Ot.a.Delete]}]]),Tt(this,"_renderItem",()=>{const{entry:e}=this.props,{isRenaming:t,name:n}=this.state,i=t?" ":e.item.path.split("/").pop();return r.createElement("div",null,this.state.error?r.createElement("div",{className:Object(a.css)(Wt.error)},this.state.error.message):null,r.createElement(It,{entry:e}),r.createElement("span",{className:Object(a.css)(Wt.label,Object(d.m)(e.item.path)?Wt.labelTest:void 0,e.state.isError?Wt.labelError:void 0)},i),t?r.createElement("input",{autoFocus:!0,type:"text",value:n,onChange:this._handleInputChange,onFocus:this._handleInputFocus,onBlur:this._handleInputBlur,onKeyUp:this._handleInputKeyUp,className:Object(a.css)(Wt.input)}):null)}),Tt(this,"_renderTree",()=>{const{entry:e,rest:t,clipboard:n,onCreateFile:i,onCreateFolder:s,onOpen:o,onSelect:l,onFocus:c,onPaste:d,onRename:p,onExpand:h,onDelete:m,onCopy:u,onClearClipboard:g,theme:b}=this.props;return"folder"===e.item.type&&t.length&&e.state.isExpanded?r.createElement("div",{className:Object(a.css)(Wt.child)},r.createElement(zt,{parent:e.item.path,entries:t,clipboard:n,onCreateFile:i,onCreateFolder:s,onOpen:o,onSelect:l,onFocus:c,onCopy:u,onPaste:d,onRename:p,onExpand:h,onDelete:m,onClearClipboard:g,sdkVersion:this.props.sdkVersion,theme:b})):null}),Tt(this,"_renderMenuIcon",()=>r.createElement("svg",{className:Object(a.css)(Wt.icon),viewBox:"0 0 16 16"},r.createElement("circle",{cy:"3",cx:"8",r:"1.5"}),r.createElement("circle",{cy:"8",cx:"8",r:"1.5"}),r.createElement("circle",{cy:"13",cx:"8",r:"1.5"})));const{entry:n}=e;this.state={name:n.state.isCreating&&null!==(t=n.item.path.split("/").pop())&&void 0!==t?t:"",error:null,isRenaming:!n.item.asset&&!!n.state.isCreating}}componentDidMount(){this.props.entry.state.isCreating&&this.props.onOpen(this.props.entry.item.path)}render(){var e;const{entry:t,rest:n,onOpen:a,onFocus:i,onRename:s,onExpand:o,theme:l}=this.props,c=!(null!==(e=Object(d.f)(this.props.entry.item.path)||this.props.entry.item.virtual)&&void 0!==e?e:this.props.entry.state.isCreating);return r.createElement(Mt,{entry:t,rest:n,onOpen:a,onFocus:i,onRename:s,onExpand:o,renderItem:this._renderItem,renderTree:this._renderTree,renderMenuIcon:this._renderMenuIcon,actions:this._getActions(),draggable:c,theme:l})}}const Wt=a.StyleSheet.create({child:{marginLeft:16},label:{verticalAlign:-1,margin:"0 6px",userSelect:"none"},labelError:{color:Object(m.a)("error")},labelTest:{color:Object(m.a)("soft")},input:{position:"absolute",top:0,left:35,height:28,margin:1,border:"1px solid ".concat(Object(m.a)("selected")),borderRadius:3,backgroundColor:Object(m.a)("content"),outline:0,paddingLeft:2},error:{backgroundColor:Object(m.a)("error"),color:Object(m.a)("error-text"),padding:"4px 8px",position:"fixed",marginTop:-32,marginLeft:20,borderRadius:3},icon:{height:16,width:16,opacity:.7,fill:"currentColor"}});class zt extends r.PureComponent{constructor(...e){var t,n,a;super(...e),a=()=>this.props.entries.filter(e=>!e.item.path.replace(new RegExp("^".concat(St()(this.props.parent),"/")),"").includes("/")),(n="_getImmediateChildren")in(t=this)?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a}render(){const{entries:e,clipboard:t,onCreateFile:n,onCreateFolder:i,onFocus:s,onOpen:o,onSelect:l,onPaste:c,onRename:p,onExpand:h,onDelete:m,onCopy:u,onClearClipboard:g,className:b,theme:f}=this.props;return r.createElement("div",{className:"".concat(Object(a.css)(Ht.container)," ").concat(null!=b?b:"")},this._getImmediateChildren().sort((e,t)=>e.item.type===t.item.type?e.item.path.startsWith(".")&&!t.item.path.startsWith(".")?1:t.item.path.startsWith(".")&&!e.item.path.startsWith(".")?-1:e.item.path.localeCompare(t.item.path):"folder"===e.item.type?-1:1).map(a=>r.createElement(At,{key:a.item.path,entry:a,rest:e.filter(e=>Object(d.h)(e.item.path,a.item.path)),clipboard:t,onCreateFile:n,onCreateFolder:i,onOpen:o,onSelect:l,onFocus:s,onCopy:u,onPaste:c,onDelete:m,onRename:p,onExpand:h,onClearClipboard:g,getAdjacentEntries:this._getImmediateChildren,sdkVersion:this.props.sdkVersion,theme:f})))}}const Ht=a.StyleSheet.create({container:{display:"inline-block",width:"100%"}});function Bt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Vt extends r.PureComponent{constructor(...e){super(...e),Bt(this,"state",{isHovered:!1,menu:null}),Bt(this,"_hideContextMenu",()=>this.setState({menu:null})),Bt(this,"_showContextMenu",e=>{this.setState({menu:{pageX:e.pageX,pageY:e.pageY}})}),Bt(this,"_handleDocumentClick",e=>{this.state.menu&&this._menu.current&&e.target!==this._menu.current&&!this._menu.current.contains(e.target)&&this._hideContextMenu()}),Bt(this,"_handleDocumentContextMenu",e=>{var t;e.target===this._item.current||null!==(t=this._item.current)&&void 0!==t&&t.contains(e.target)?(e.preventDefault(),this._showContextMenu(e)):this.state.menu&&this._hideContextMenu()}),Bt(this,"_handleMouseEnter",()=>this.setState({isHovered:!0})),Bt(this,"_handleMouseLeave",()=>this.setState({isHovered:!1})),Bt(this,"_menu",r.createRef()),Bt(this,"_item",r.createRef())}componentDidMount(){document.addEventListener("click",this._handleDocumentClick),document.addEventListener("contextmenu",this._handleDocumentContextMenu)}componentWillUnmount(){document.removeEventListener("click",this._handleDocumentClick),document.removeEventListener("contextmenu",this._handleDocumentContextMenu)}render(){const{entry:e,theme:t}=this.props,n=e.item.path.split("/").pop();return r.createElement("li",{ref:this._item,tabIndex:-1,className:Object(a.css)(Zt.item,e.state.isFocused&&("dark"===t?Zt.focusedDark:Zt.focusedLight)),onMouseEnter:this._handleMouseEnter,onMouseLeave:this._handleMouseLeave},r.createElement("button",{onClick:this.props.onClose,className:Object(a.css)(Zt.close,this.state.isHovered?Zt.closeFocused:Zt.closeBlurred)},"×"),r.createElement("div",{onClick:this.props.onOpen},r.createElement(It,{entry:e}),r.createElement("span",{className:Object(a.css)(Zt.label,e.state.isError?Zt.labelError:void 0)},n)),r.createElement(ze,{ref:this._menu,visible:Boolean(this.state.menu),position:this.state.menu,actions:[{label:"Close",handler:this.props.onClose},{label:"Close Others",handler:this.props.onCloseOthers},{label:"Close All",handler:this.props.onCloseAll}],onHide:this._hideContextMenu}))}}var Ut=Object(te.a)(Vt);const Zt=a.StyleSheet.create({item:{paddingLeft:24,cursor:"pointer",outline:0,whiteSpace:"nowrap"},label:{display:"inline-block",verticalAlign:-1,margin:6,userSelect:"none",whiteSpace:"nowrap"},labelError:{color:Object(m.a)("error")},focusedLight:{backgroundColor:"rgba(0, 0, 0, .04)"},focusedDark:{backgroundColor:"rgba(255, 255, 255, .04)"},close:{padding:"7px 8px",fontSize:"18px",border:"none",appearance:"none",position:"absolute",left:0,margin:"-3px 0 0 0",background:"none",outline:0},closeFocused:{opacity:1},closeBlurred:{opacity:0}});function Kt({title:e,expanded:t,buttons:n,children:i,onClick:s,className:o}){return r.createElement("div",{className:"".concat(null!=o?o:""," ").concat(Object(a.css)(Yt.container))},r.createElement("div",{className:Object(a.css)(Yt.header)},r.createElement("div",{className:Object(a.css)(Yt.left),onClick:s,"data-test-id":"file-list-pane-".concat(e.toLowerCase().replace(/[^a-z]/g,"-"))},r.createElement("svg",{className:Object(a.css)(Yt.collapse,t?Yt.collapseExpanded:Yt.collapseCollapsed),width:"12px",height:"12px",viewBox:"0 0 12 12"},r.createElement("g",{stroke:"none",strokeWidth:"2",fill:"none",fillRule:"evenodd",strokeLinecap:"round",strokeLinejoin:"round"},r.createElement("polyline",{stroke:"currentColor",transform:"translate(6.000000, 6.000000) scale(-1, 1) rotate(180.000000) translate(-6.000000, -6.000000) ",points:"2 4 6 8 10 4"}))),r.createElement("h4",{className:Object(a.css)(Yt.label)},e)),r.createElement("div",{className:Object(a.css)(Yt.right)},n)),t?i:null)}const Yt=a.StyleSheet.create({container:{display:"flex",flexDirection:"column"},header:{display:"flex",flexDirection:"row",alignItems:"center",padding:"0 4px"},label:{fontSize:"1em",fontWeight:500,lineHeight:1,margin:0},collapse:{margin:"1px 6px 1px 2px",opacity:.7},collapseCollapsed:{transform:"rotate(180deg)"},collapseExpanded:{transform:"rotate(0deg)"},left:{flex:1,display:"flex",flexDirection:"row",padding:"8px 4px",cursor:"pointer"},right:{display:"flex",flexDirection:"row",alignItems:"center"}});function $t(e,t){return{...e,item:t.item?{...e.item,...t.item}:e.item,state:t.state?{...e.state,...t.state}:e.state}}function Jt(e){if("file"===e.item.type){if(e.state.isSelected||e.state.isFocused||e.state.isOpen)return $t(e,{state:{isOpen:!1,isSelected:!1,isFocused:!1}})}else if(e.state.isSelected)return $t(e,{state:{isSelected:!1}});return e}function qt(e,t,n,a){const i=t?e.find(e=>e.item.path===t):null,s=i?"folder"===i.item.type?i.item.path:Object(d.b)(i.item.path):null,r=n.item.path.split("/").pop(),o=$t(n,{item:{path:Object(d.c)(e.map(e=>e.item.path),s?"".concat(s,"/").concat(r):r,a)}});return o.state={isCreating:!0},o}function Xt(e,t,n){const a="file"===t?{item:{path:"Untitled file.js",type:"file",content:""},state:{isCreating:!0}}:{item:{path:"Untitled folder",type:"folder"},state:{isCreating:!0}};let i=n;if("string"!=typeof i){const t=e.find(e=>!0===e.state.isSelected);i=t?t.item.path:void 0}const s=qt(e,i,a);return[...e.map(e=>"folder"===e.item.type&&Object(d.h)(s.item.path,e.item.path)&&!e.state.isExpanded?$t(e,{state:{isExpanded:!0}}):e),s]}function Gt(e,t,n=!1){const a=e.find(e=>e.item.path===t),i=!!a&&"folder"===a.item.type;return e.map(e=>{if(e.item.path===t)return"file"===e.item.type?e.state.isSelected&&e.state.isFocused&&e.state.isOpen?e:$t(e,{state:{isSelected:!0,isFocused:!0,isOpen:!0}}):$t(e,{state:{isSelected:!0,isExpanded:n?e.state.isExpanded:!e.state.isExpanded}});if("file"===e.item.type){if(e.state.isSelected||e.state.isFocused)return $t(e,{state:{isSelected:!1,isFocused:!!i&&e.state.isFocused}})}else if(e.state.isSelected)return $t(e,{state:{isSelected:!1}});return e})}function Qt(e,t,n){const a=[];let i=Object(d.b)(t);for(;i;){const t=e.find(e=>e.item.path===i);if(t){if("folder"!==t.item.type)throw new Error("File path must be inside a folder");break}a.push({item:{type:"folder",path:i},state:{isExpanded:!!n}}),i=Object(d.b)(i)}return a}const en=e=>{const t=e.split("/");if(0===t.length)return[];const n=[];for(let e=0;e<t.length-1;e++)n.push(t.slice(0,e+1).join("/"));return n};function tn(e,t,n,a){const i=!!n.find(({location:t,severity:n})=>(null==t?void 0:t.fileName)===e&&n<0),s=!i&&!!n.find(({location:t,severity:n})=>(null==t?void 0:t.fileName)===e&&n>=3);if("ASSET"===t.type)return a&&"file"===a.item.type&&a.item.asset?a.item.uri===t.contents&&a.state.isError===s&&a.state.isLoading===i?a:{item:{...a.item,uri:t.contents},state:{...a.state,isError:s,isLoading:i}}:{item:{path:e,type:"file",uri:t.contents,asset:!0},state:{isError:s,isLoading:i}};{const n=Object(d.f)(e);return a&&"file"===a.item.type&&!a.item.asset?a.item.content===t.contents&&a.state.isError===s&&a.state.isLoading===i?a:{item:{...a.item,content:t.contents},state:{...a.state,isError:s,isLoading:i}}:{item:{path:e,type:"file",content:t.contents,virtual:"package.json"===e},state:{isOpen:n,isSelected:n,isFocused:n,isError:s,isLoading:i}}}}function nn(e){return e.find(e=>"file"===e.item.type&&e.state.isFocused)}function an(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const sn=()=>r.createElement("g",{transform:"translate(7.000000, 7.000000)"},r.createElement("circle",{fill:Object(m.a)("success"),cx:"4.5",cy:"4.5",r:"4.5"}),r.createElement("rect",{fill:Object(m.a)("success-text"),x:"4",y:"2",width:"1",height:"5"}),r.createElement("rect",{fill:Object(m.a)("success-text"),x:"2",y:"4",width:"5",height:"1"}));class rn extends r.PureComponent{constructor(...e){super(...e),an(this,"state",{clipboard:[],deleted:[],openFilesPane:!0,projectPane:!0,entries:[],selectedFile:""}),an(this,"_handleEntrySelect",e=>{this.updateEntries(function(e,t){return e.map(e=>e.item.path===t?$t(e,{state:{isSelected:!e.state.isSelected}}):e)}(this.state.entries,e))}),an(this,"_handleEntryOpen",e=>{this.updateEntries(Gt(this.state.entries,e))}),an(this,"_handleEntryFocus",e=>{this.updateEntries(Gt(this.state.entries,e,!0))}),an(this,"_handleEntryExpand",(e,t)=>this.updateEntries(function(e,t,n=!0){return e.map(e=>e.item.path===t&&"folder"===e.item.type?$t(e,{state:{isExpanded:n}}):e)}(this.state.entries,e,t))),an(this,"_handleEntryRename",(e,t)=>{if(e===t)return;const n=this.state.entries.find(t=>t.item.path===e);n&&("folder"===n.item.type?this.state.entries.filter(t=>"file"===t.item.type&&t.item.path.startsWith(e)).forEach(n=>{this.props.onRenameFile(n.item.path,"".concat(t).concat(n.item.path.substring(e.length)))}):this.props.onRenameFile(e,t)),this.updateEntries(function(e,t,n){const a=e.find(e=>e.item.path===t);if(!a)return e;const i=$t(a,{item:{path:n}});delete i.state.isCreating;const s=e.map(e=>e.item.path===a.item.path?i:"folder"===i.item.type&&Object(d.h)(e.item.path,a.item.path)?$t(e,{item:{path:Object(d.a)(e.item.path,a.item.path,i.item.path)}}):e),r=Qt(s,i.item.path,!0);return[...s,...r]}(this.state.entries,e,t))}),an(this,"_restoreEntries",e=>this.updateEntries([...this.state.entries,...e.map(e=>$t(e,{item:{path:Object(d.c)(this.state.entries.map(e=>e.item.path),e.item.path)}}))])),an(this,"_handleDismissDelete",e=>this.setState(t=>({deleted:t.deleted.filter(t=>t.id!==e)}))),an(this,"_handleEntryClose",e=>this.updateEntries(this.state.entries.map(t=>t.item.path===e?Jt(t):t))),an(this,"_handleEntryCloseOthers",e=>this.updateEntries(this.state.entries.map(t=>t.item.path!==e?Jt(t):t))),an(this,"_handleEntryCloseAll",()=>this.updateEntries(this.state.entries.map(e=>Jt(e)))),an(this,"_handleEntryDelete",e=>{const t=this.state.entries.find(t=>t.item.path===e),n=[];this.updateEntries(this.state.entries.filter(t=>{const a=t.item.path===e||Object(d.h)(t.item.path,e);return a&&(n.push(t),"file"===t.item.type&&this.props.onRemoveFile(t.item.path)),!a})),this.setState(e=>({deleted:[...e.deleted,{id:this._currentDeleteID++,path:t?t.item.path:"Item",entries:n}]}))}),an(this,"_currentDeleteID",0),an(this,"_handleEntryImport",e=>{let t;if(Object(d.j)(e.item.path))t=this.state.entries.map(t=>{if(Object(d.j)(t.item.path))try{const n=JSON.parse(t.item.content),a=JSON.parse(e.item.content);return{...t,item:{...t.item,content:JSON.stringify({...n,dependencies:{...n.dependencies,...Object.keys(a.dependencies).reduce((e,t)=>(Object(st.isModulePreloaded)(t,this.props.sdkVersion,!0)||(e[t]=a.dependencies[t]),e),{})}},null,2)}}}catch(e){}return t});else if(Object(d.e)(e.item.path))try{const n=JSON.parse(e.item.content);n.plugins&&(n.plugins=n.plugins.filter(e=>rt.plugins.includes(e)),n.plugins.length||delete n.plugins),n.rules&&(n.rules=it()(n.rules,(e,t)=>t.includes("/")?rt.plugins.some(e=>t.startsWith("".concat(e,"/"))):t)),n.extends&&("string"!=typeof n.extends||n.extends.startsWith("eslint:")?(n.extends=n.extends.filter(e=>e.startsWith("eslint:")),n.extends.length||delete n.extends):delete n.extends),t=this.state.entries.filter(e=>!Object(d.e)(e.item.path)),t.push($t(e,{item:{content:JSON.stringify(n,null,2)}}))}catch(e){t=this.state.entries}else{const n=Qt(this.state.entries,e.item.path);t=[...this.state.entries,...n],t.push($t(e,{item:{path:Object(d.c)(t.map(e=>e.item.path),e.item.path)}}))}this.updateEntries(t)}),an(this,"_handleEntryPaste",(e,t)=>this.updateEntries(function(e,t,n){const a=qt(e,t,n,"- Copy");if("folder"===n.item.type){const t=e.filter(e=>Object(d.h)(e.item.path,n.item.path)).map(e=>$t(e,{item:{path:Object(d.a)(e.item.path,n.item.path,a.item.path)}}));return[...e,...t,a]}return[...e,a]}(this.state.entries,e,t))),an(this,"_handleCopy",e=>this.setState(t=>({clipboard:t.entries.filter(t=>t.item.path===e)}))),an(this,"_handleClearClipboard",()=>this.setState({clipboard:[]})),an(this,"_toggleOpenFilesPane",()=>this.setState(e=>({openFilesPane:!e.openFilesPane}))),an(this,"_toggleProjectPane",()=>this.setState(e=>({projectPane:!e.projectPane}))),an(this,"_handleCreateFile",e=>{let t=Xt(this.state.entries,"file",e);const n=t.find(e=>!this.state.entries.find(t=>t.item.path===e.item.path));t=n?Gt(t,n.item.path,!0):t,this.updateEntries(t)}),an(this,"_handleCreateFolder",e=>{this.updateEntries(Xt(this.state.entries,"folder",e))})}static getDerivedStateFromProps(e,t){let n=function(e,t,n){const a=[],i=new Set;for(const r of Object.keys(e).sort()){for(const e of en(r)){var s;if(!i.has(e))a.push(null!==(s=n.find(t=>t.item.path===e))&&void 0!==s?s:{item:{path:e,type:"folder"},state:{}}),i.add(e)}const o=e[r],l=n.find(e=>e.item.path===r);a.push(tn(r,o,t,l))}return n.forEach(e=>{"folder"!==e.item.type||i.has(e.item.path)||a.push(e)}),a}(e.files,e.annotations,t.entries);return n=t.selectedFile!==e.selectedFile?Gt(n,e.selectedFile):n,{entries:n,selectedFile:e.selectedFile}}updateEntries(e){const t=this.state.entries;this.setState({entries:e}),this.props.updateFiles(t=>{const n={};for(const a in t){e.find(e=>e.item.path===a)||(n[a]=null)}return e.forEach(e=>{"file"!==e.item.type||t[e.item.path]||Object(d.j)(e.item.path)||(n[e.item.path]={type:e.item.asset?"ASSET":"CODE",contents:e.item.asset?e.item.uri:e.item.content})}),n});const n=nn(t),a=nn(e);var i;(null==a?void 0:a.item.path)!==(null==n?void 0:n.item.path)&&this.props.onSelectFile(null!==(i=null==a?void 0:a.item.path)&&void 0!==i?i:"")}render(){return r.createElement(yt,{className:Object(a.css)(ln.container),entries:this.state.entries,onImportFile:this._handleEntryImport,uploadFileAsync:this.props.uploadFileAsync,render:({onImportStart:e})=>this.props.visible?r.createElement(K,{direction:"horizontal",className:Object(a.css)(ln.pane)},r.createElement(xt.a,null,r.createElement(Kt,{className:Object(a.css)(this.state.projectPane?ln.openFilesSmall:ln.openFilesLarge),title:"Open files",expanded:this.state.openFilesPane,onClick:this._toggleOpenFilesPane},r.createElement("ul",{className:Object(a.css)(ln.tabs),"data-test-id":"file-list-open-files-content"},this.state.entries.filter(e=>"file"===e.item.type&&e.state.isOpen).map(e=>r.createElement(Ut,{key:e.item.path,entry:e,onOpen:()=>this._handleEntryOpen(e.item.path),onClose:()=>this._handleEntryClose(e.item.path),onCloseOthers:()=>this._handleEntryCloseOthers(e.item.path),onCloseAll:this._handleEntryCloseAll})))),r.createElement(Kt,{className:Object(a.css)(ln.project),title:"Project",expanded:this.state.projectPane,onClick:this._toggleProjectPane,buttons:[r.createElement(ct,{key:"create-file",onClick:()=>this._handleCreateFile()},r.createElement("path",{fillOpacity:"0.7",d:"M3,2 L13,2 L13,14 L3,14 L3,2 Z M9,2 L13,6 L13,2 L9,2 Z M9,6 L9,2 L8,2 L8,7 L13,7 L13,6 L9,6 Z"}),r.createElement(sn,null)),r.createElement(ct,{key:"create-folder",onClick:()=>this._handleCreateFolder()},r.createElement("path",{fillOpacity:"0.7",d:"M7.25,4 L7.5,4 L7.5,3 L7,3.5 L7,2 L15,2 L15,4 L7.25,4 Z M6.75,4 L5,4 L7,2 L7,3.5 L6.5,4 L6.75,4 Z M1,4 L15,4 L15,14 L1,14 L1,4 Z M7.5,3 L7.5,4 L14,4 L14,3 L7.5,3 Z"}),r.createElement(sn,null)),r.createElement(ht,{key:"menu",onImportFilesClick:e,onImportRepoClick:()=>this.props.onShowModal("import-repo"),onImportProductionClick:()=>this.props.onShowModal("import-production"),onExportClick:this.props.onDownloadCode,saveStatus:this.props.saveStatus,hasSnackId:this.props.hasSnackId})]},r.createElement(Lt,{className:Object(a.css)(ln.files),rest:this.state.entries,onRename:this._handleEntryRename},r.createElement("div",{className:Object(a.css)(ln.children),"data-test-id":"file-list-project-content"},r.createElement(zt,{parent:"",entries:this.state.entries,clipboard:this.state.clipboard,onCreateFile:this._handleCreateFile,onCreateFolder:this._handleCreateFolder,onOpen:this._handleEntryOpen,onSelect:this._handleEntrySelect,onFocus:this._handleEntryFocus,onPaste:this._handleEntryPaste,onRename:this._handleEntryRename,onExpand:this._handleEntryExpand,onDelete:this._handleEntryDelete,onCopy:this._handleCopy,onClearClipboard:this._handleClearClipboard,sdkVersion:this.props.sdkVersion,theme:this.props.theme,className:Object(a.css)(ln.list)})))),this.state.deleted.map(e=>r.createElement(wt.a,{key:e.id,label:"Deleted ".concat(e.path.split("/").pop()),actions:[{label:"Undo",action:()=>{this._restoreEntries(e.entries),this._handleDismissDelete(e.id)}},{label:"Dismiss"}],onDismiss:()=>this._handleDismissDelete(e.id)})).reverse())):null})}}var on=Object(te.a)(rn);const ln=a.StyleSheet.create({container:{display:"flex",flexDirection:"column"},list:{padding:"0 12px",height:"100%"},pane:{flex:1,display:"flex",flexDirection:"column",width:240,minWidth:240,height:"100%",zIndex:10},project:{flex:1},openFilesSmall:{maxHeight:"50%"},openFilesLarge:{maxHeight:"calc(100% - 30px)"},files:{flex:"1 0 0",overflow:"auto",paddingBottom:16},children:{position:"relative"},tabs:{margin:0,listStyle:"none",padding:"8px 0",overflow:"auto",":empty":{display:"none"}},toolbar:{padding:8},toasts:{position:"fixed",bottom:"3em",left:"1em",zIndex:10}});var cn=n(91);function dn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class pn extends r.PureComponent{constructor(...e){super(...e),dn(this,"state",{isLoading:!1,error:"",url:"",resetDependencies:!1}),dn(this,"_hideImportModal",()=>{this.setState({isLoading:!1,error:"",url:"",resetDependencies:!1}),this.props.onHide()}),dn(this,"_handleImportClick",async e=>{e.preventDefault(),this.setState({isLoading:!0,error:""});try{var t;const e=this.state.url.match(/^https:\/\/snack\.expo\.io\/(.*)/);if(!e)throw new Error("Invalid url");const n=e[1],a=await fetch("https://exp.host/--/api/v2/snack/".concat(n),{headers:{"Snack-Api-Version":"3.0.0"}}),i=await a.text(),s=JSON.parse(i);if(null!==(t=s.errors)&&void 0!==t&&t.length)throw new Error(JSON.stringify(s.errors));const r={...s,dependencies:Object(st.standardizeDependencies)(s.dependencies)};this.props.onSubmitMetadata({name:r.manifest.name,description:r.manifest.description}),r.manifest.sdkVersion&&this.props.onChangeSDKVersion(r.manifest.sdkVersion),this.props.updateFiles(e=>{const t={};for(const n in e)t[n]=null;const n="string"==typeof r.code?{"App.js":{contents:r.code,type:"CODE"}}:r.code;for(const e in n)t[e]=n[e];return t}),this.props.updateDependencies(e=>{const t={};for(const n in e)t[n]=null;for(const e in r.dependencies)this.state.resetDependencies?t[e]={version:r.dependencies[e].version}:t[e]=r.dependencies[e];return t}),this.setState({isLoading:!1}),this.props.onHide()}catch(e){this.setState({isLoading:!1,error:e.message})}}),dn(this,"_handleChange",e=>{this.setState({url:e.target.value})}),dn(this,"_toggleResetDependencies",()=>{this.setState(e=>({resetDependencies:!e.resetDependencies}))})}render(){const{visible:e}=this.props,{isLoading:t,error:n,url:i,resetDependencies:s}=this.state;return r.createElement(ge.a,{visible:e,onDismiss:this._hideImportModal,title:"Import from production"},t?r.createElement(cn.a,{duration:45e3,className:Object(a.css)(hn.progress)}):null,r.createElement("form",{onSubmit:this._handleImportClick},r.createElement("p",{className:n?Object(a.css)(hn.errorParagraph):Object(a.css)(hn.paragraph)},n?"An error occurred during import. ".concat(n):"Import a saved Snack from production. This will overwrite all your current files and dependencies with the contents of the saved Snack."),r.createElement(Ee.a,{name:"url",value:i,onChange:this._handleChange,placeholder:"https://snack.expo.io/82kWr6arT",autoFocus:!0}),r.createElement("div",{className:Object(a.css)(hn.switch)},r.createElement(P.a,{checked:s,label:"Reset resolved dependencies",onChange:this._toggleResetDependencies})),r.createElement("div",{className:Object(a.css)(hn.buttons)},r.createElement(ue.a,{large:!0,disabled:!i,loading:t,type:"submit",variant:"primary"},t?"Importing Snack...":"Import Snack"))))}}const hn=a.StyleSheet.create({paragraph:{margin:"8px 0 16px"},errorParagraph:{margin:"8px 0 16px",color:Object(m.a)("error")},progress:{marginTop:-16},switch:{display:"flex",flexDirection:"row"},buttons:{margin:"16px 0 0 0"}});var mn=n(755),un=n.n(mn),gn=n(180),bn=n.n(gn);function fn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class vn extends r.PureComponent{constructor(...e){super(...e),fn(this,"state",{status:"idle",advanced:!1,url:"",repo:"",path:"",branch:""}),fn(this,"_hideImportModal",()=>{l.a.getInstance().logEvent("IMPORT_COMPLETED",{reason:"dismiss"},"importStart"),this.setState({status:"idle",url:"",repo:"",path:"",branch:""}),this.props.onHide()}),fn(this,"_handleImportRepoClick",async e=>{let t,n;e.preventDefault(),this.setState({status:"importing"}),setTimeout(()=>{this.props.visible&&"importing"===this.state.status&&this.setState({status:"error"})},45e3);let a=!1;try{const e="".concat(this.props.snackagerURL,"/git"),i={repo:this.state.repo};this.state.path&&(i.subpath=this.state.path),this.state.branch&&(i.branch=this.state.branch),t=await fetch("".concat(e,"?").concat(bn.a.stringify(i))),n=await t.text(),this.props.visible&&(t.ok?(l.a.getInstance().logEvent("IMPORT_COMPLETED",{reason:"success"},"importStart"),this.props.preventRedirectWarning(),window.location.href="/".concat(n)):a=!0)}catch(e){a=!0}a?(this.setState({error:n,status:"error"}),l.a.getInstance().logEvent("IMPORT_COMPLETED",{reason:"error"},"importStart")):this.setState({status:"idle"})}),fn(this,"_handleChange",e=>{this.setState({[e.target.name]:e.target.value})}),fn(this,"_handleChangeUrl",e=>{const t=e.target.value,n=un()(t);this.setState({url:t,repo:"".concat(n.protocol,"://").concat(n.source,"/").concat(n.owner,"/").concat(n.name),path:n.filepath,branch:n.ref})})}render(){const{status:e,error:t,url:n,repo:i,path:s,branch:o,advanced:l}=this.state,c="importing"===e,d="error"===e;return r.createElement(ge.a,{visible:this.props.visible,onDismiss:this._hideImportModal,title:"Import git repository"},c?r.createElement(cn.a,{duration:45e3,className:Object(a.css)(yn.progress)}):null,r.createElement("form",{onSubmit:this._handleImportRepoClick},r.createElement("p",{className:d?Object(a.css)(yn.errorParagraph):Object(a.css)(yn.paragraph)},d?"An error occurred during import. This could be because the data provided was invalid, or because the repository referenced is not a properly formatted Expo project.":"Import an Expo project from a Public Git repository."),d&&r.createElement("p",{className:Object(a.css)(yn.errorParagraph)},t),l?r.createElement(r.Fragment,null,r.createElement("h4",{className:Object(a.css)(yn.subtitle)},"Repository URL"),r.createElement(Ee.a,{name:"repo",value:i,onChange:this._handleChange,placeholder:"https://github.com/ide/love-languages.git",autoFocus:!0}),r.createElement("h4",{className:Object(a.css)(yn.subtitle)},"Folder path"),r.createElement(Ee.a,{name:"path",value:s,onChange:this._handleChange,placeholder:"/example/app"}),r.createElement("h4",{className:Object(a.css)(yn.subtitle)},"Branch name"),r.createElement(Ee.a,{name:"branch",value:o,onChange:this._handleChange,placeholder:"main"})):r.createElement(r.Fragment,null,r.createElement("h4",{className:Object(a.css)(yn.subtitle)},"Git URL"),r.createElement(ve,{minRows:2,value:n,onChange:this._handleChangeUrl,placeholder:"https://github.com/ide/love-languages/tree/main/app",autoFocus:!0})),r.createElement("button",{type:"button",onClick:()=>this.setState(e=>({advanced:!e.advanced})),className:Object(a.css)(yn.advanced)},l?"Hide":"Show"," advanced options"),r.createElement("div",{className:Object(a.css)(yn.buttons)},r.createElement(ue.a,{large:!0,disabled:!i,loading:c,type:"submit",variant:"primary"},c?"Importing repository…":"Import repository"))))}}const yn=a.StyleSheet.create({paragraph:{margin:"8px 0 16px"},errorParagraph:{margin:"8px 0 16px",color:Object(m.a)("error")},subtitle:{fontSize:16,fontWeight:500,padding:0,lineHeight:"22px",margin:"16px 0 6px 0"},progress:{marginTop:-16},advanced:{appearance:"none",background:"none",border:0,padding:"8px 0",marginTop:8,textAlign:"left",width:"100%",color:Object(m.a)("selected")},buttons:{margin:"16px 0 0 0"}});class En extends r.PureComponent{render(){return r.createElement("div",{className:Object(a.css)(xn.container)},r.createElement("h4",{className:Object(a.css)(xn.text)},"Select a file to view and edit"))}}const xn=a.StyleSheet.create({container:{flex:1,display:"flex",alignItems:"center",justifyContent:"center"},text:{fontSize:"1.5em",fontWeight:500,opacity:.5}});var wn=n(592),Cn=n(178),Sn=n(766),On=n.n(Sn);class jn extends r.Component{render(){const{saveHistory:e,theme:t}=this.props,i=e.filter(e=>!e.isDraft);return r.createElement("div",{className:Object(a.css)(kn.container)},i.length?r.createElement(r.Fragment,null,r.createElement("p",{className:Object(a.css)(kn.hint)},"Click on a previous save to open it in a new tab. You can make changes and then save it to overwrite the current version, or change the name to save as a new Snack."),i.map(e=>r.createElement("a",{key:e.hashId,target:"_blank",href:"/".concat(e.hashId),className:Object(a.css)(kn.item)},r.createElement("div",null,r.createElement("h4",{className:Object(a.css)(kn.title)},On()(e.savedAt,"hh:mm a, dddd")),r.createElement("p",{className:Object(a.css)(kn.description)},On()(e.savedAt,"Do MMMM YYYY"))),r.createElement("img",{className:Object(a.css)(kn.icon),src:n("dark"===t?541:540),alt:"Open in new tab"})))):r.createElement("p",{className:Object(a.css)(kn.placeholder)},"There are no previous saves for this Snack."))}}var _n=Object(te.a)(jn);const kn=a.StyleSheet.create({container:{margin:-12,paddingTop:8,textAlign:"left"},hint:{margin:12},item:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:12,cursor:"pointer",color:"inherit",textDecoration:"none",borderRadius:3,"--icon-opacity":"0",":hover":{"--icon-opacity":"1",backgroundColor:Object(m.a)("hover")}},title:{fontSize:16,fontWeight:"bold",marginTop:0,marginBottom:4},description:{fontSize:14,margin:0,whiteSpace:"nowrap",textOverflow:"ellipsis"},icon:{margin:8,height:16,width:16,opacity:"var(--icon-opacity)"},placeholder:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:96,margin:24,fontSize:16,opacity:.5}});var Ln=n(593);class Dn extends r.Component{render(){return r.createElement(ge.a,{visible:this.props.visible,onDismiss:this.props.onDismiss,title:"Experience already exists!"},r.createElement("p",{className:Object(a.css)(Nn.text)},'You already have an experience published under "',this.props.username?"@".concat(this.props.username,"/").concat(this.props.slug):this.props.slug,'" in your profile. Please choose another name for the Snack and save again.'),r.createElement(ue.a,{large:!0,variant:"secondary",onClick:this.props.onEditName},"Choose another name"))}}const Nn=a.StyleSheet.create({text:{marginTop:12,fontSize:16,textAlign:"center"}});class Mn extends r.Component{constructor(...e){var t,n,a;super(...e),a=e=>{this.props.visible&&13===e.keyCode&&(e.preventDefault(),this.props.onPublish())},(n="_handleKeyDown")in(t=this)?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a}componentDidMount(){document.addEventListener("keydown",this._handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this._handleKeyDown)}render(){const e="save2"===this.props.authFlow?"Want a stable and easy to remember URL?":"Want to easily find this snack again?",t="save2"===this.props.authFlow?"Save to your Expo Profile":"Save to Profile";return r.createElement(ge.a,{visible:this.props.visible,title:"Save your snack",onDismiss:this.props.onDismiss},r.createElement("p",{className:Object(a.css)(In.text),style:{marginTop:16}},"The shareable link to your Snack"," ",r.createElement("a",{href:this.props.snackUrl,target:"blank"},this.props.snackUrl)),r.createElement("p",{className:Object(a.css)(In.text)},"Every time you save, your will get a new link to share. ",e," Log in or sign up and save to your profile!"),r.createElement(ue.a,{large:!0,variant:"primary",onClick:this.props.onPublish,loading:this.props.isPublishing},t),this.props.zipUrl?r.createElement("p",{className:Object(a.css)(In.caption)},r.createElement("a",{className:Object(a.css)(In.link),href:this.props.zipUrl,target:"blank"},"Download .zip file")):null)}}var Pn=Object(o.b)(e=>({authFlow:e.splitTestSettings.authFlow||"save1"}))(Mn);const In=a.StyleSheet.create({text:{marginBottom:24,fontSize:"16px",padding:"0 24px 0 24px",lineHeight:"22px",textAlign:"center"},caption:{marginTop:24,fontSize:"16px",lineHeight:"22px",textAlign:"center"},link:{color:Object(m.a)("primary"),cursor:"pointer",textDecoration:"underline"}});class Fn extends r.PureComponent{render(){return r.createElement(ge.a,{visible:this.props.visible,onDismiss:this.props.onDismiss,title:"Couldn't save the Snack!"},r.createElement("p",{className:Object(a.css)(Tn.text)},"An unknown error occurred when saving your Snack. Please try again later."))}}const Tn=a.StyleSheet.create({text:{marginTop:12,fontSize:16,textAlign:"center"}});function Rn({color:e,segments:t=12,segmentWidth:n=2,segmentLength:i=6,spacing:s=4,fadeTo:o=31/98,fadeSteps:l=6}){const[c]=Object(ke.a)(),{red:d,green:p,blue:h,alpha:m}=void 0!==e?e:"dark"===c.theme?{red:255,green:255,blue:255,alpha:.5}:{red:70,green:48,blue:235,alpha:1},u=2*n+s,g=(1-o)/l,b=[];for(let e=0;e<t;e++){const n=1-Math.min(e,l)*g,a=360*-e/t;b.push(r.createElement("line",{key:e,x1:"0",y1:u,x2:"0",y2:u+i,style:{opacity:n},transform:"rotate(".concat(a,")")}))}const f="rgba(".concat(d,", ").concat(p,", ").concat(h,", ").concat(m,")"),v=u+i+Math.ceil(n/2);return r.createElement("svg",{className:Object(a.css)(An.indicator),width:2*v,height:2*v},r.createElement("g",{stroke:f,strokeWidth:n,strokeLinecap:"round",transform:"translate(".concat(v,", ").concat(v,")")},b))}const An=a.StyleSheet.create({indicator:{animationDuration:"1s",animationIterationCount:"infinite",animationName:{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}},animationTimingFunction:"steps(12)"}});function Wn(e){return r.createElement(ge.a,{visible:e.visible,onDismiss:e.onDismiss,title:"Saving Snack…"},r.createElement("div",{className:Object(a.css)(zn.content)},r.createElement(Rn,null)))}const zn=a.StyleSheet.create({content:{margin:"16px 8px 12px"}});class Hn extends r.PureComponent{constructor(...e){var t,n,a;super(...e),a=()=>{this.props.onDismiss&&this.props.onDismiss(),l.a.getInstance().logEvent("VIEWED_OWNED_USER_SNACKS")},(n="_dismissModal")in(t=this)?Object.defineProperty(t,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[n]=a}componentDidUpdate(e){!e.visible&&this.props.visible&&l.a.getInstance().logEvent("CREATED_USER_SNACK")}render(){var e;const t=null===(e=this.props.viewer)||void 0===e?void 0:e.picture;return r.createElement(ge.a,{visible:this.props.visible,onDismiss:this.props.onDismiss},t?r.createElement("div",{className:Object(a.css)(Vn.avatar)},r.createElement(Te,{source:t,size:80})):null,r.createElement("h2",{className:Object(a.css)(Vn.heading)},"Your Snack was saved"),r.createElement("p",{className:Object(a.css)(Vn.text)},"You can now find your Snack on your profile and link others to it. Share it with your friends!"),this.props.viewer?r.createElement("p",{className:Object(a.css)(Vn.caption)},r.createElement("a",{href:"".concat("https://expo.io","/@").concat(this.props.viewer.username,"/snacks"),onClick:this._dismissModal,target:"blank"},"View your Snacks")):null)}}var Bn=Hn;const Vn=a.StyleSheet.create({avatar:{marginTop:16,marginBottom:24,textAlign:"center"},heading:{fontSize:"24px",fontWeight:500,lineHeight:"24px",textAlign:"center"},text:{marginBottom:24,fontSize:"16px",padding:"0 24px 0 24px",lineHeight:"22px",textAlign:"center"},caption:{fontSize:"16px",lineHeight:"22px",textAlign:"center"}});function Un(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Zn extends r.Component{constructor(...e){super(...e),Un(this,"state",{isPublishInProgress:!1,isPublishing:!1,hasShownEditNameDialog:!1}),Un(this,"_publishWithOptionsAsync",async e=>{this.setState({isPublishing:!0});try{await this.props.onPublishAsync(e)}catch(e){throw/Experience .+ already exists/.test(e.message)?this.props.onShowModal("publish-overwrite-experience-error"):this.props.onShowModal("publish-unknown-error"),e}finally{this.setState({isPublishing:!1})}}),Un(this,"_handleSaveToProfile",async()=>{Boolean(this.props.viewer)?(this.props.onShowModal("publish-working"),this._handlePublishAsync()):window.location.href=Object(Q.a)({saveToAccount:!0})}),Un(this,"_handleSubmitMetadata",async e=>{this.props.onSubmitMetadata(e),await this._handlePublishAsync()}),Un(this,"_handlePublishAsync",async(e={})=>{this.setState({isPublishInProgress:!0}),this.props.name&&(Object(Ln.a)(this.props.name)||this.state.hasShownEditNameDialog)?(await this._publishWithOptionsAsync(e),this.props.onShowModal(this.props.viewer?"publish-success":"publish-prompt-save")):(this.props.onShowModal("publish-edit-name"),this.setState({hasShownEditNameDialog:!0}))}),Un(this,"_handlePublishAbort",()=>{this.props.onHideModal(),this.setState({isPublishInProgress:!1})})}render(){const{id:e,viewer:t,name:n,description:a,currentModal:i,children:s}=this.props,{isPublishInProgress:o}=this.state;return r.createElement(r.Fragment,null,s({onPublishAsync:this._handlePublishAsync,isPublishing:this.state.isPublishing}),r.createElement(Se,{visible:o&&"publish-edit-name"===i,title:"Save your Snack",action:this.state.isPublishing?"Saving…":"Save",isWorking:this.state.isPublishing,name:n,description:a,onSubmit:this._handleSubmitMetadata,onDismiss:this._handlePublishAbort}),r.createElement(Pn,{visible:o&&"publish-prompt-save"===i,snackUrl:e?"".concat("https://snack.expo.io","/").concat(e):void 0,onPublish:this._handleSaveToProfile,isPublishing:this.state.isPublishing,onDismiss:this._handlePublishAbort}),r.createElement(Bn,{visible:o&&"publish-success"===i,viewer:t,onDismiss:this._handlePublishAbort}),r.createElement(Fn,{visible:o&&"publish-unknown-error"===i,onDismiss:this._handlePublishAbort}),r.createElement(Wn,{visible:o&&"publish-working"===i,onDismiss:this._handlePublishAbort}),r.createElement(Dn,{visible:o&&"publish-overwrite-experience-error"===i,slug:n,username:null==t?void 0:t.username,onEditName:()=>this.props.onShowModal("publish-edit-name"),onDismiss:this._handlePublishAbort}))}}var Kn=Object(Fe.a)(Zn),Yn=n(114),$n=n(115),Jn=n(216),qn=n(179);function Xn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Gn extends r.Component{constructor(...e){super(...e),Xn(this,"state",{currentModal:null,currentBanner:null,loadedEditor:null,isMarkdownPreview:!0,deviceLogsShown:!1,lintedFiles:{},lintAnnotations:[],shouldPreventRedirectWarning:!1}),Xn(this,"_handleUnload",e=>{if(!("edited"===this.props.saveStatus||"publishing"===this.props.saveStatus||"saving-draft"===this.props.saveStatus)||this.state.shouldPreventRedirectWarning)return void this._allowRedirectWarning();const t="You have unsaved changes. Are you sure you want to leave this page?";return e.returnValue=t,t}),Xn(this,"_lintNotDebounced",async(e,t,n)=>{const{lintedFiles:a}=this.state;let i=null;for(const e in t){var s;const n=t[e];if(!Object(d.m)(e)&&"CODE"===n.type&&n.contents!==(null===(s=a[e])||void 0===s?void 0:s.code)){var r;const s=await p(e,t);i=null!==(r=i)&&void 0!==r?r:{...a},i[e]={code:n.contents,annotations:s}}}for(const e in a){var o;if(!t[e]||"CODE"!==t[e].type)i=null!==(o=i)&&void 0!==o?o:{...a},delete i[e]}i&&this.setState(()=>({lintedFiles:i,lintAnnotations:Object.values(i).flatMap(({annotations:e})=>e)}))}),Xn(this,"_lint",s()(this._lintNotDebounced,500)),Xn(this,"_prettier",async()=>{const{selectedFile:e,files:t}=this.props,n=t[e];if("CODE"===(null==n?void 0:n.type)){let t;t=Object(d.i)(e)?JSON.stringify(JSON.parse(n.contents),null,2):await Object(h.a)(e,n.contents),t!==n.contents&&this.props.updateFiles(()=>({[e]:{type:"CODE",contents:t}}))}}),Xn(this,"_showBanner",(e,t=5e3)=>{this.setState({currentBanner:e}),setTimeout(()=>{this.setState(t=>t.currentBanner===e?{currentBanner:null}:null)},t)}),Xn(this,"_handleHideModal",()=>{switch(this.state.currentModal){case"edit-info":l.a.getInstance().logEvent("DISMISSED_AUTH_MODAL",{currentModal:this.state.currentModal})}this.setState({currentModal:null})}),Xn(this,"_handleShowModal",e=>{switch(e){case"device-instructions":l.a.getInstance().logEvent("REQUESTED_QR_CODE");break;case"embed":if(!this.props.id)return void this._showBanner("embed-unavailable",5e3);l.a.getInstance().logEvent("REQUESTED_EMBED")}this.setState({currentModal:e})}),Xn(this,"_handleShowShortcuts",()=>{this._handleShowModal("shortcuts")}),Xn(this,"_handleRemoveFile",e=>{var t;null===(t=this._EditorComponent)||void 0===t||t.removePath(e)}),Xn(this,"_handleRenameFile",(e,t)=>{var n;null===(n=this._EditorComponent)||void 0===n||n.renamePath(e,t)}),Xn(this,"_EditorComponent",void 0),Xn(this,"_showErrorPanel",()=>this.props.setPreferences({panelType:"errors"})),Xn(this,"_showDeviceLogs",()=>this.props.setPreferences({panelType:"logs"})),Xn(this,"_togglePanels",e=>this.props.setPreferences({panelsShown:!this.props.preferences.panelsShown,panelType:e&&!this.props.preferences.panelsShown?e:this.props.preferences.panelType})),Xn(this,"_toggleFileTree",()=>this.props.setPreferences({fileTreeShown:!this.props.preferences.fileTreeShown})),Xn(this,"_changeConnectionMethod",e=>this.props.setPreferences({deviceConnectionMethod:e})),Xn(this,"_toggleEditorMode",()=>this.props.setPreferences({editorMode:"vim"===this.props.preferences.editorMode?"normal":"vim"})),Xn(this,"_toggleTheme",()=>this.props.setPreferences({theme:"light"===this.props.preferences.theme?"dark":"light"})),Xn(this,"_toggleMarkdownPreview",()=>this.setState(e=>({isMarkdownPreview:!e.isMarkdownPreview}))),Xn(this,"_preventRedirectWarning",()=>this.setState({shouldPreventRedirectWarning:!0})),Xn(this,"_allowRedirectWarning",()=>this.setState({shouldPreventRedirectWarning:!1}))}static getDerivedStateFromProps(e,t){var n;const{selectedFile:a,files:i}=e;let s=null;return!t.isMarkdownPreview||!a.endsWith(".md")||null!==(n=i[a])&&void 0!==n&&n.contents||(s=s||{},s.isMarkdownPreview=!1),s}componentDidMount(){window.addEventListener("beforeunload",this._handleUnload),setTimeout(()=>{this._lint(this.props.selectedFile,this.props.files,this.props.sdkVersion),Object(h.a)(Object(d.k)(this.props.selectedFile)?this.props.selectedFile:"index.md","")},5e3),this.props.upgradedFromSDKVersion&&(this.props.upgradedFromSDKVersion>this.props.sdkVersion?this._showBanner("sdk-downgraded"):this._showBanner("sdk-upgraded"))}componentDidUpdate(e){this.props.files!==e.files&&this._lint(this.props.selectedFile,this.props.files,this.props.sdkVersion),e.connectedDevices!==this.props.connectedDevices&&(e.connectedDevices.length<this.props.connectedDevices.length&&(l.a.getInstance().logEvent("CONNECTED_DEVICE"),0===e.connectedDevices.length&&l.a.getInstance().startTimer("deviceConnected"),this._showBanner("connected",1500)),e.connectedDevices.length>this.props.connectedDevices.length&&(0===this.props.connectedDevices.length?l.a.getInstance().logEvent("DISCONNECTED_DEVICE",{},"deviceConnected"):l.a.getInstance().logEvent("DISCONNECTED_DEVICE"),this._showBanner("disconnected",1500))),e.sdkVersion!==this.props.sdkVersion&&this.props.connectedDevices.length&&this._showBanner("reconnect"),e.autosaveEnabled===this.props.autosaveEnabled||this.props.autosaveEnabled||this._showBanner("autosave-disabled")}componentWillUnmount(){window.removeEventListener("beforeunload",this._handleUnload)}render(){const{currentModal:e,currentBanner:t,lintAnnotations:i}=this.state,{id:s,createdAt:o,experienceURL:l,experienceName:d,saveHistory:p,saveStatus:h,viewer:m,snackagerURL:u,files:b,selectedFile:f,dependencies:E,deviceId:w,isResolving:C,sendCodeOnChangeEnabled:S,sdkVersion:O,isLocalWebPreview:j,userAgent:_,connectedDevices:k,deviceLogs:L,onSendCode:D,onReloadSnack:N,onClearDeviceLogs:M,onChangePlatform:P,onToggleSendCode:F,onTogglePreview:T,uploadFileAsync:R,preferences:A,name:W,description:z,previewRef:H,previewURL:B,platform:V,platformOptions:U,previewShown:Z,isDownloading:K}=this.props,Y=i.length?[...this.props.annotations,...i]:this.props.annotations;return r.createElement(Yn.a,null,this.state.loadedEditor?null:r.createElement(cn.a,null),r.createElement(wn.a,{name:W,description:z,id:s}),r.createElement(Kn,{id:s,sdkVersion:O,name:W,description:z,onSubmitMetadata:this.props.onSubmitMetadata,onPublishAsync:this.props.onPublishAsync,onShowModal:this._handleShowModal,onHideModal:this._handleHideModal,currentModal:e},({onPublishAsync:i})=>r.createElement(r.Fragment,null,r.createElement(Ot.b,{bindings:x.a,onTrigger:e=>{const t={save:"published"===h||this.props.isResolving?null:i,tree:this._toggleFileTree,panels:this._togglePanels,format:this._prettier,shortcuts:this._handleShowShortcuts,update:D}[e];t&&t()}}),r.createElement(Ke,{name:W,description:z,createdAt:o,saveHistory:p,saveStatus:h,sdkVersion:O,viewer:m,isDownloading:K,isResolving:C,visibleModal:e,onShowModal:this._handleShowModal,onHideModal:this._handleHideModal,onSubmitMetadata:this.props.onSubmitMetadata,onDownloadCode:this.props.onDownloadAsync,onPublishAsync:i}),r.createElement("div",{className:Object(a.css)(Qn.editorAreaOuterWrapper)},r.createElement("div",{className:Object(a.css)(Qn.editorAreaOuter)},r.createElement(Jn.a,null,r.createElement(on,{annotations:Y,visible:A.fileTreeShown,files:b,selectedFile:f,updateFiles:this.props.updateFiles,onSelectFile:this.props.onSelectFile,onRemoveFile:this._handleRemoveFile,onRenameFile:this._handleRenameFile,uploadFileAsync:R,onDownloadCode:this.props.onDownloadAsync,onShowModal:this._handleShowModal,hasSnackId:!!s,saveStatus:h,sdkVersion:O}),r.createElement(qn.a,{load:async()=>{if(Object(c.c)(_)){const e=await Promise.all([n.e(0),n.e(3),n.e(7)]).then(n.bind(null,586));return this.setState({loadedEditor:"simple"}),e}let e;const t=Promise.all([n.e(17),n.e(6)]).then(n.bind(null,896)).then(e=>({editor:e,type:"monaco"})),a=new Promise((t,a)=>{e=setTimeout(()=>{this._showBanner("slow-connection"),Promise.all([n.e(0),n.e(3),n.e(7)]).then(n.bind(null,586)).then(t,a)},3e3)}).then(e=>({editor:e,type:"simple"}));return Promise.race([t.catch(()=>a),a]).then(({editor:t,type:n})=>(this.setState({loadedEditor:n}),clearTimeout(e),t))}},({loaded:e,data:t})=>{this._EditorComponent=t;const i=b[f];if(!i)return r.createElement(En,null);{if("ASSET"===i.type)return r.createElement(g,{selectedFile:f,files:b});const{contents:s}=i,o=f.endsWith(".md");if(o&&this.state.isMarkdownPreview)return r.createElement(r.Fragment,null,r.createElement(qn.a,{load:()=>Promise.all([n.e(0),n.e(19),n.e(10)]).then(n.bind(null,897))},({loaded:e,data:t})=>e&&t?r.createElement(t,{source:s}):r.createElement($n.a,null)),r.createElement("button",{className:Object(a.css)(Qn.previewToggle),onClick:this._toggleMarkdownPreview},r.createElement("svg",{width:"12px",height:"12px",viewBox:"0 0 18 18",className:Object(a.css)(Qn.previewToggleIcon)},r.createElement("g",{transform:"translate(-147.000000, -99.000000)"},r.createElement("g",{transform:"translate(144.000000, 96.000000)"},r.createElement("path",{d:"M3,17.25 L3,21 L6.75,21 L17.81,9.94 L14.06,6.19 L3,17.25 L3,17.25 Z M20.71,7.04 C21.1,6.65 21.1,6.02 20.71,5.63 L18.37,3.29 C17.98,2.9 17.35,2.9 16.96,3.29 L15.13,5.12 L18.88,8.87 L20.71,7.04 L20.71,7.04 Z"}))))));if(e&&t)return r.createElement(r.Fragment,null,r.createElement(t,{dependencies:E,sdkVersion:O,selectedFile:f,files:b,autoFocus:!/Untitled file.*\.(js|tsx?)$/.test(f),annotations:Y,updateFiles:this.props.updateFiles,onSelectFile:this.props.onSelectFile,mode:A.editorMode,lineNumbers:Object(c.c)(_)?"off":void 0}),o?r.createElement("button",{className:Object(a.css)(Qn.previewToggle),onClick:this._toggleMarkdownPreview},r.createElement("svg",{width:"16px",height:"12px",viewBox:"0 0 22 16",className:Object(a.css)(Qn.previewToggleIcon)},r.createElement("g",{transform:"translate(-145.000000, -1156.000000)"},r.createElement("g",{transform:"translate(144.000000, 1152.000000)"},r.createElement("path",{d:"M12,4.5 C7,4.5 2.73,7.61 1,12 C2.73,16.39 7,19.5 12,19.5 C17,19.5 21.27,16.39 23,12 C21.27,7.61 17,4.5 12,4.5 L12,4.5 Z M12,17 C9.24,17 7,14.76 7,12 C7,9.24 9.24,7 12,7 C14.76,7 17,9.24 17,12 C17,14.76 14.76,17 12,17 L12,17 Z M12,9 C10.34,9 9,10.34 9,12 C9,13.66 10.34,15 12,15 C13.66,15 15,13.66 15,12 C15,10.34 13.66,9 12,9 L12,9 Z"}))))):null)}return r.createElement($n.a,null)})),A.panelsShown?r.createElement(J,{annotations:Y,deviceLogs:L,onShowErrorPanel:this._showErrorPanel,onShowDeviceLogs:this._showDeviceLogs,onTogglePanels:this._togglePanels,onClearDeviceLogs:M,onSelectFile:this.props.onSelectFile,panelType:A.panelType}):null),Z?r.createElement(y.default,{className:Object(a.css)(Qn.preview),width:334,connectedDevices:k,deviceId:w,experienceURL:l,experienceName:d,name:W,onChangePlatform:P,onShowModal:this._handleShowModal,onReloadSnack:N,onSendCode:D,onToggleSendCode:F,platform:V,platformOptions:U,previewRef:H,previewURL:B,sdkVersion:O,setDeviceId:this.props.setDeviceId,sendCodeOnChangeEnabled:S}):null),r.createElement(I,{annotations:Y,connectedDevices:k,fileTreeShown:A.fileTreeShown,previewShown:Z,panelsShown:A.panelsShown,editorMode:A.editorMode,sendCodeOnChangeEnabled:S,sdkVersion:O,isLocalWebPreview:j,onSendCode:D,onReloadSnack:N,onToggleTheme:this._toggleTheme,onTogglePanels:this._togglePanels,onToggleFileTree:this._toggleFileTree,onTogglePreview:T,onToggleSendCode:F,onToggleVimMode:"monaco"===this.state.loadedEditor?this._toggleEditorMode:void 0,onChangeSDKVersion:this.props.onChangeSDKVersion,onShowModal:this._handleShowModal,onPrettifyCode:this._prettier,theme:this.props.preferences.theme}),r.createElement(v.a,{visible:"device-instructions"===e,onDismiss:this._handleHideModal,onChangeMethod:this._changeConnectionMethod,method:A.deviceConnectionMethod,experienceURL:l,isEmbedded:!1,setDeviceId:this.props.setDeviceId,deviceId:w}),r.createElement(ge.a,{className:Object(a.css)(Qn.embedModal),autoSize:!1,visible:"embed"===e,onDismiss:this._handleHideModal},r.createElement(tt,{id:s,sdkVersion:O,platformOptions:U})),r.createElement(ge.a,{visible:"previous-saves"===e,title:"Previous saves",onDismiss:this._handleHideModal},r.createElement(_n,{saveHistory:p})),r.createElement(ge.a,{visible:"shortcuts"===e,onDismiss:this._handleHideModal},r.createElement(x.b,null)),r.createElement(vn,{visible:"import-repo"===e,onHide:this._handleHideModal,preventRedirectWarning:this._preventRedirectWarning,snackagerURL:u}),r.createElement(pn,{visible:"import-production"===e,onHide:this._handleHideModal,onSubmitMetadata:this.props.onSubmitMetadata,onChangeSDKVersion:this.props.onChangeSDKVersion,updateFiles:this.props.updateFiles,updateDependencies:this.props.updateDependencies}),r.createElement(qe.a,{type:"success",visible:"connected"===t},"Device connected!"),r.createElement(qe.a,{type:"error",visible:"disconnected"===t},"Device disconnected!"),r.createElement(qe.a,{type:"info",visible:"autosave-disabled"===t},"Automatic saving has been disabled in this Snack because you have it open in another tab."),r.createElement(qe.a,{type:"info",visible:"sdk-upgraded"===t},"This Snack was written in an older Expo version that is not longer supported. We have upgraded the Expo version to ",O,".",r.createElement("br",null),"You might need to do some manual changes to make the Snack work correctly."),r.createElement(qe.a,{type:"info",visible:"sdk-downgraded"===t},"The requested Expo version is not yet supported. We have downgraded the Expo version to ",O,".",r.createElement("br",null),"You might need to do some manual changes to make the Snack work correctly."),r.createElement(qe.a,{type:"info",visible:"reconnect"===t},"Please close and reopen Expo Go on your phone to see the Expo version change."),r.createElement(qe.a,{type:"info",visible:"slow-connection"===t},"Slow network detected. Trying to load a basic version of the editor. Some features such as linting and autocomplete may not work."),r.createElement(qe.a,{type:"info",visible:"embed-unavailable"===t},"You need to save the Snack first to get an Embed code!"))))}}t.default=Object(Cn.a)(Object(o.b)(e=>({viewer:e.viewer}))(Object(f.a)(Gn)));const Qn=a.StyleSheet.create({editorAreaOuter:{display:"flex",flex:1,flexDirection:"column",minWidth:0,minHeight:0},editorAreaOuterWrapper:{display:"flex",flex:1,flexDirection:"row",minHeight:0,minWidth:0},embedModal:{minWidth:0,minHeight:0,maxWidth:"calc(100% - 48px)",maxHeight:"calc(100% - 48px)"},preview:{backgroundColor:Object(m.a)("content"),borderLeft:"1px solid ".concat(Object(m.a)("border"))},previewToggle:{appearance:"none",position:"absolute",right:0,bottom:0,margin:32,padding:12,height:48,width:48,border:0,borderRadius:"50%",backgroundColor:Object(m.a)("secondary"),color:Object(m.a)("secondary-text"),outline:0,transitionDuration:"170ms",transitionProperty:"box-shadow",transitionTimingFunction:"linear",":focus-visible":{outline:"auto"},":hover":{boxShadow:Object(m.c)("small")}},previewToggleIcon:{fill:"currentColor",verticalAlign:-1}})}}]);